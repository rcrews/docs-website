<html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="UTF-8"><meta name="DC.Type" content="reference"><meta name="description" content="In Spark, you can use the Hive Warehouse Connector for accessing ACID table data in Hive."><meta name="DC.subject" content="Hive, Spark, Hive Warehouse Connector, HiveWarehouseConnector"><meta name="keywords" content="Hive, Spark, Hive Warehouse Connector, HiveWarehouseConnector"><meta name="DC.Relation" scheme="URI" content="../topics/cr-hive_hivewarehouseconnector_for_handling_apache_spark_data.html"><meta name="DC.Relation" scheme="URI" content="https://github.com/hortonworks/hive-warehouse-connector-release"><meta name="DC.Relation" scheme="URI" content="http://docs-dev.cloudera.com.s3.amazonaws.com/HDPDocuments/CR/CR-master/developing-spark-applications/content/using_spark_hive_warehouse_connector.html"><meta name="prodname" content="Cloudera Runtime"><meta name="version" content="1"><meta name="release" content="0"><meta name="modification" content="0"><meta name="brand" content="Cloudera Runtime"><meta name="rights" content="© 2019 Cloudera, Inc."><meta name="DC.Date.Created" content="2019-04-15"><meta name="DC.Date.Modified" content="2019-04-15"><meta name="DC.Format" content="XHTML"><meta name="DC.Identifier" content="hive_configure_a_connection_between_apache_spark_and_apache_hive"><link rel="stylesheet" type="text/css" href="../commonltr.css"><title>Apache Spark-Apache Hive connection configuration</title><script type="application/javascript">
      
      
    //The id for tree cookie
    var treeCookieId = "treeview-bk_release-notes";
    var language = "en";
    var w = new Object();
    //Localization
    txt_filesfound = 'Results';
    txt_enter_at_least_1_char = "You must enter at least one character.";
    txt_browser_not_supported = "Please enable JavaScript.";
    txt_please_wait = "Please wait. Search in progress...";
    txt_results_for = "Results for: ";
    
    
    </script><script type="application/javascript" src="https://code.jquery.com/jquery-1.4.3.min.js"></script><script type="application/javascript" src="/common/themes/pre-hdp-3.1/js/jquery-ui-1.8.2.custom.min.js"></script><script type="application/javascript" src="/common/themes/pre-hdp-3.1/js/jquery.cookie.js"></script><script type="application/javascript" src="/common/themes/pre-hdp-3.1/js/jquery.treeview.min.js"></script><link href="https://cdn.jsdelivr.net/qtip2/3.0.3/jquery.qtip.min.css" rel="stylesheet" type="text/css" media="screen, projection"><script src="https://cdnjs.cloudflare.com/ajax/libs/qtip2/3.0.3/jquery.qtip.min.js" type="application/javascript"></script><script type="application/javascript" src="/common/js/navigation.js"></script><script type="application/javascript" src="/common/themes/pre-hdp-3.1/js/main.js"></script><script type="application/javascript" src="/common/themes/pre-hdp-3.1/js/htmlFileList.js"></script><script type="application/javascript" src="/common/themes/pre-hdp-3.1/js/htmlFileInfoList.js"></script><script type="application/javascript" src="/common/themes/pre-hdp-3.1/js/nwSearchFnt.js"></script><script type="application/javascript" src="/common/themes/pre-hdp-3.1/js/en_stemmer.js"></script><script type="application/javascript" src="/common/themes/pre-hdp-3.1/js/index-1.js"></script><script type="application/javascript" src="/common/themes/pre-hdp-3.1/js/index-2.js"></script><script type="application/javascript" src="/common/themes/pre-hdp-3.1/js/index-3.js"></script><script type="application/javascript">
      
      
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-22950817-19', 'auto');
    ga('send', 'pageview');
    
    
    </script><script type="application/javascript" src="/common/themes/pre-hdp-3.1/js/plugins.js"></script><script type="application/javascript" src="/common/themes/pre-hdp-3.1/js/scripts.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.3.0/highlight.min.js" type="application/javascript"></script><script type="application/javascript">
      
    // PAGE SPECIFIC SCRIPTS
    
    $('.chapters>li .dropdown').click(function () {
    var $arrow = $(this).find('i.fa');
    if( $arrow.hasClass('fa-chevron-down')) {
    $(this).siblings('.sections').show();
    $arrow.removeClass('fa-chevron-down').addClass('fa-chevron-up');
    } else {
    console.log('up');
    $(this).siblings('.sections').hide();
    $arrow.removeClass('fa-chevron-up').addClass('fa-chevron-down');
    }
    });
    
    //  $('h3').on('mouseenter',function() {
    //      console.log('received mouseover');
    //      $(this).find('.hash-link').show();
    //  });
    
    //  $('h3').on('mouseleave',function() {
    //      $(this).find('.hash-link').hide();
    //  });
    
    
    // STICKY SIDEBARs
    var stickySidebar = $('.sticky');
    
    if (stickySidebar.length > 0) {
    var stickyHeight = stickySidebar.height(),
    sidebarTop = stickySidebar.offset().top;
    }
    
    // on scroll move the sidebar
    $(window).scroll(function () {
    if (stickySidebar.length > 0) {
    var scrollTop = $(window).scrollTop();
    console.log
    
    if (sidebarTop < scrollTop) {
    stickySidebar.css('top', scrollTop - sidebarTop);
    
    // stop the sticky sidebar at the footer to avoid overlapping
    var sidebarBottom = stickySidebar.offset().top + stickyHeight,
    stickyStop = $('.main-content').offset().top + $('.main-content').height();
    if (stickyStop < sidebarBottom) {
    var stopPosition = $('.main-content').height() - stickyHeight;
    stickySidebar.css('top', stopPosition);
    }
    }
    else {
    stickySidebar.css('top', '0');
    }
    }
    });
    
    $(window).resize(function () {
    if (stickySidebar.length > 0) {
    stickyHeight = stickySidebar.height();
    }
    });
    
    // Initialize Syntax Highlighting
    hljs.initHighlightingOnLoad();
    
    </script><style type="text/css">
      
      
    input {
    margin-bottom: 5px;
    margin-top: 2px;
    }
    
    .folder {
    display: block;
    height: 22px;
    padding-left: 20px;
    background: transparent url(/common/themes/pre-hdp-3.1/images/folder.gif) 0 0px no-repeat;
    }
    
    </style><link href="/common/themes/pre-hdp-3.1/images/favicon.ico" rel="icon" type="image/x-icon" sizes="16x16"><link href="https://hortonworks.com/wp-content/uploads/2016/04/cropped-favicon521x512-70x70.png" rel="icon" type="image/x-icon" sizes="32x32"><link href="https://hortonworks.com/wp-content/uploads/2016/04/cropped-favicon521x512-300x300.png" rel="icon" type="image/x-icon" sizes="192x192"><link href="https://hortonworks.com/wp-content/uploads/2016/04/cropped-favicon521x512-300x300.png" rel="apple-touch-icon-precomposed" type="image/x-icon" sizes="192x192"><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.3.0/styles/default.min.css" rel="stylesheet"><link rel="stylesheet" media="screen, projection" href="/common/themes/pre-hdp-3.1/css/main.css"><link rel="stylesheet" media="screen, projection" href="/common/themes/pre-hdp-3.1/css/docux.css"><style type="text/css"></style><link rel="stylesheet" type="text/css" media="screen, projection" href="/common/themes/pre-hdp-3.1/css/jquery-ui-1.8.2.custom.css"><link rel="stylesheet" type="text/css" media="screen, projection" href="/common/themes/pre-hdp-3.1/css/jquery.treeview.css"><link href="https://cdn.jsdelivr.net/qtip2/3.0.3/jquery.qtip.min.css" rel="stylesheet" type="text/css" media="screen, projection"></head><body class="docs books"><div id="body_container"><div class="breadcrumb_bg"><!-- --></div><div id="navbar"><section class="ps topstrip"><div><!-- --></div></section></div><div id="mainbody"><section class="ps titlebar"><div><div class="breadcrumb"><a href="/">Hortonworks Docs</a> » <a id="index_page" href="../../index.html">Cloudera Runtime 1.0.0</a> » <span class="current_book">Integrating Apache Hive with Spark and BI</span></div><div class="book_title">Integrating Apache Hive with Spark and BI</div><div class="ebooks"><div class="formats"><span class="desc">Also available as:</span><div class="format"><a onclick="_gaq.push(['_trackEvent', 'Header', 'pdfDownload', 'click', 1]);" title="Download a PDF of this document" class="pdficon" href="../cr-hive_integrating_hive_and_bi.pdf"><img src="/common/themes/pre-hdp-3.1/images/pdf.png" alt="PDF"></a></div></div></div></div></section><div class="lowerbody"><section class="ps doc-content"><div><div class="aside left"><div><div id="leftnavigation" style="padding-top:3px; background-color:white;"><div class="ui-tabs ui-widget ui-widget-content ui-corner-all"><div id="treeDiv" class="ui-tabs-panel ui-widget-content ui-corner-bottom"><img src="/common/themes/pre-hdp-3.1/images/loading.gif" alt="loading table of contents..." id="tocLoading" style="display:block;"><div id="ulTreeDiv" style="display:none" class="thisisthat"><ul id="tree" class="filetree"><li><a href="../topics/cr-hive_hivewarehouseconnector_for_handling_apache_spark_data.html">Hive Warehouse Connector for accessing Apache Spark data</a><ul><li class="active"><a href="../topics/cr-hive_apache_spark_hive_connection_configuration.html">Apache Spark-Apache Hive connection configuration</a></li><li><a href="../topics/cr-hive_submit_a_hivewarehouseconnector_app.html">Submit a Hive Warehouse Connector Scala or Java application</a></li><li><a href="../topics/cr-hive_submit_a_hivewarehouseconnector_python.html">Submit a Hive Warehouse Connector Python app</a></li><li><a href="../topics/cr-hive_hivewarehouseconnector_supported_types.html">Hive Warehouse Connector supported types</a></li><li><a href="../topics/cr-hive_hivewarehousesession_api_operations.html">HiveWarehouseSession API operations</a></li><li><a href="../topics/cr-hive_use_hwc_for_streaming.html">Use the Hive Warehouse Connector for streaming</a></li></ul></li><li><a href="../topics/cr-hive_query_sql_using_jdbcstoragehandler.html">Query a SQL data source using the JdbcStorageHandler</a></li></ul></div></div></div></div></div><div class="formats"><div class="pdf"><!-- --></div></div></div><div class="next-prev-links"></div><div id="content" aria-labelledby="ariaid-title1">
  <h1 class="title topictitle1" id="ariaid-title1">Apache Spark-Apache Hive connection configuration</h1>
  
  
  <div class="body refbody"><p class="shortdesc">In Spark, you can use the Hive Warehouse Connector for accessing ACID table data in
    Hive. </p>
    <section class="section"><h2 class="title sectiontitle">Prerequisites</h2>
      
      <p class="p">You need to use the following software to connect Spark and Hive using the
        HiveWarehouseConnector library.</p>
      <ul class="ul">
        <li class="li">Spark2</li>
        <li class="li">Hive LLAP<p class="p">The Hive Warehouse Connector (HWC) and low-latency analytical processing
            (LLAP) are required for certain tasks, as shown in the following table:</p><table class="table frame-all" id="hive_configure_a_connection_between_apache_spark_and_apache_hive__table_cdm_cvd_4hb"><caption><span class="table--title-label">Table 1. </span><span class="title">Spark Compatibility</span></caption><colgroup><col style="width:25%"><col style="width:25%"><col style="width:25%"><col style="width:25%"></colgroup><thead class="thead">
                <tr class="row">
                  <th class="entry" id="hive_configure_a_connection_between_apache_spark_and_apache_hive__table_cdm_cvd_4hb__entry__1">Tasks</th>
                  <th class="entry" id="hive_configure_a_connection_between_apache_spark_and_apache_hive__table_cdm_cvd_4hb__entry__2">HWC Required</th>
                  <th class="entry" id="hive_configure_a_connection_between_apache_spark_and_apache_hive__table_cdm_cvd_4hb__entry__3">LLAP Required</th>
                  <th class="entry" id="hive_configure_a_connection_between_apache_spark_and_apache_hive__table_cdm_cvd_4hb__entry__4">Other Requirement/Comments</th>
                </tr>
              </thead><tbody class="tbody">
                <tr class="row">
                  <td class="entry" headers="hive_configure_a_connection_between_apache_spark_and_apache_hive__table_cdm_cvd_4hb__entry__1 ">Read Hive managed tables from Spark</td>
                  <td class="entry" headers="hive_configure_a_connection_between_apache_spark_and_apache_hive__table_cdm_cvd_4hb__entry__2 ">Yes</td>
                  <td class="entry" headers="hive_configure_a_connection_between_apache_spark_and_apache_hive__table_cdm_cvd_4hb__entry__3 ">Yes</td>
                  <td class="entry" headers="hive_configure_a_connection_between_apache_spark_and_apache_hive__table_cdm_cvd_4hb__entry__4 ">Ranger ACLs enforced.</td>
                </tr>
                <tr class="row">
                  <td class="entry" headers="hive_configure_a_connection_between_apache_spark_and_apache_hive__table_cdm_cvd_4hb__entry__1 ">Write Hive managed tables from Spark</td>
                  <td class="entry" headers="hive_configure_a_connection_between_apache_spark_and_apache_hive__table_cdm_cvd_4hb__entry__2 ">Yes</td>
                  <td class="entry" headers="hive_configure_a_connection_between_apache_spark_and_apache_hive__table_cdm_cvd_4hb__entry__3 ">No</td>
                  <td class="entry" headers="hive_configure_a_connection_between_apache_spark_and_apache_hive__table_cdm_cvd_4hb__entry__4 ">Ranger ACLs enforced.</td>
                </tr>
                <tr class="row">
                  <td class="entry" headers="hive_configure_a_connection_between_apache_spark_and_apache_hive__table_cdm_cvd_4hb__entry__1 ">Read Hive external tables from Spark</td>
                  <td class="entry" headers="hive_configure_a_connection_between_apache_spark_and_apache_hive__table_cdm_cvd_4hb__entry__2 ">No</td>
                  <td class="entry" headers="hive_configure_a_connection_between_apache_spark_and_apache_hive__table_cdm_cvd_4hb__entry__3 ">Only if HWC is used</td>
                  <td class="entry" headers="hive_configure_a_connection_between_apache_spark_and_apache_hive__table_cdm_cvd_4hb__entry__4 ">Table must be defined in Spark catalog. Ranger ACLs not enforced.</td>
                </tr>
                <tr class="row">
                  <td class="entry" headers="hive_configure_a_connection_between_apache_spark_and_apache_hive__table_cdm_cvd_4hb__entry__1 ">Write Hive external tables from Spark</td>
                  <td class="entry" headers="hive_configure_a_connection_between_apache_spark_and_apache_hive__table_cdm_cvd_4hb__entry__2 ">No</td>
                  <td class="entry" headers="hive_configure_a_connection_between_apache_spark_and_apache_hive__table_cdm_cvd_4hb__entry__3 ">No</td>
                  <td class="entry" headers="hive_configure_a_connection_between_apache_spark_and_apache_hive__table_cdm_cvd_4hb__entry__4 ">Ranger ACLs enforced.</td>
                </tr>
                <tr class="row">
                  <td class="entry" headers="hive_configure_a_connection_between_apache_spark_and_apache_hive__table_cdm_cvd_4hb__entry__1 ">Read Spark tables</td>
                  <td class="entry" headers="hive_configure_a_connection_between_apache_spark_and_apache_hive__table_cdm_cvd_4hb__entry__2 ">Yes</td>
                  <td class="entry" headers="hive_configure_a_connection_between_apache_spark_and_apache_hive__table_cdm_cvd_4hb__entry__3 ">Yes</td>
                  <td class="entry" headers="hive_configure_a_connection_between_apache_spark_and_apache_hive__table_cdm_cvd_4hb__entry__4 ">Ranger ACLs enforced.</td>
                </tr>
                <tr class="row">
                  <td class="entry" headers="hive_configure_a_connection_between_apache_spark_and_apache_hive__table_cdm_cvd_4hb__entry__1 ">Write Spark tables</td>
                  <td class="entry" headers="hive_configure_a_connection_between_apache_spark_and_apache_hive__table_cdm_cvd_4hb__entry__2 ">Yes</td>
                  <td class="entry" headers="hive_configure_a_connection_between_apache_spark_and_apache_hive__table_cdm_cvd_4hb__entry__3 ">No</td>
                  <td class="entry" headers="hive_configure_a_connection_between_apache_spark_and_apache_hive__table_cdm_cvd_4hb__entry__4 ">Ranger ACLs enforced.</td>
                </tr>
              </tbody></table><p class="p">You need low-latency analytical processing (LLAP) to read ACID, or other
            Hive-managed tables, from Spark. You do not need LLAP to write to ACID, or other managed
            tables, from Spark. The HWC library internally uses the Hive Streaming API and LOAD DATA
            Hive commands to write the data. You do not need LLAP to access external tables from
            Spark with caveats shown in the table above.</p></li>
      </ul>
    </section>
    
    <section class="section"><h2 class="title sectiontitle">Spark on a Kerberized YARN cluster</h2>
      
      <p class="p">In Spark client mode on a kerberized Yarn cluster, set the following property:
          <code class="ph codeph">spark.sql.hive.hiveserver2.jdbc.url.principal</code>.  This property must be
        equal to <code class="ph codeph">hive.server2.authentication.kerberos.principal</code>. In Ambari, copy
        the value for this property from <span class="ph menucascade"><span class="ph uicontrol">Services</span><abbr title="and then"> &gt; </abbr><span class="ph uicontrol">Hive</span><abbr title="and then"> &gt; </abbr><span class="ph uicontrol">Configs</span><abbr title="and then"> &gt; </abbr><span class="ph uicontrol">Advanced</span><abbr title="and then"> &gt; </abbr><span class="ph uicontrol">Advanced hive-site</span></span>
        <code class="ph codeph">hive.server2.authentication.kerberos.principal</code>. </p>

    </section>
  </div>
<nav role="navigation" class="related-links"><div class="familylinks"><div class="parentlink"><strong>Parent topic:</strong> <a class="link" href="../topics/cr-hive_hivewarehouseconnector_for_handling_apache_spark_data.html" title="The Hive Warehouse Connector (HWC) is a Spark library/plugin that is launched with the Spark app. You need to understand how to use HWC to access Spark tables from Hive. You also export tables to Hive from Spark and vice versa using this connector.">Hive Warehouse Connector for accessing Apache Spark data</a></div></div><div class="linklist relinfo"><strong>Related information</strong><br><div><a class="link" href="https://github.com/hortonworks/hive-warehouse-connector-release" target="_blank">HiveWarehouseConnector Github project (select a feature branch)</a></div><div><a class="link" href="http://docs-dev.cloudera.com.s3.amazonaws.com/HDPDocuments/CR/CR-master/developing-spark-applications/content/using_spark_hive_warehouse_connector.html" target="_blank">HiveWarehouseConnector for handling Apache Spark data</a></div></div></nav></div></div></section></div></div></div><section class="ps footer"><div><div class="copyright">© 2012–2019, Hortonworks, Inc.</div><div class="license">Document licensed under the <a href="https://creativecommons.org/licenses/by-sa/4.0/legalcode">Creative
          Commons Attribution ShareAlike 4.0 License</a>.</div><div class="menulinks"><a href="https://hortonworks.com">Hortonworks.com</a> | 
          <a href="#">Documentation</a> |
          <a href="https://hortonworks.com/support/">Support</a> |
          <a href="https://community.hortonworks.com/">Community</a></div></div></section></body></html>