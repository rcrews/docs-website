<html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="UTF-8"><meta name="copyright" content="(C) Copyright 2019"><meta name="DC.rights.owner" content="(C) Copyright 2019"><meta name="DC.Type" content="concept"><meta name="description" content="You can extract, transform, and load a Hive table to a Kafka topic for real-time streaming of a large volume of Hive data. You need some understanding of write semantics and the metadata columns required for writing data to Kafka."><meta name="DC.subject" content="Hive, Kafka, write to Kafka, Hive data stream"><meta name="keywords" content="Hive, Kafka, write to Kafka, Hive data stream"><meta name="DC.Relation" scheme="URI" content="https://kafka.apache.org/0110/documentation.html"><meta name="DC.Format" content="XHTML"><meta name="DC.Identifier" content="hive_performing_hive_to_kafka_etl"><link rel="stylesheet" type="text/css" href="../commonltr.css"><title>Writing data to Kafka</title><script type="application/javascript">
      
      
    //The id for tree cookie
    var treeCookieId = "treeview-bk_release-notes";
    var language = "en";
    var w = new Object();
    //Localization
    txt_filesfound = 'Results';
    txt_enter_at_least_1_char = "You must enter at least one character.";
    txt_browser_not_supported = "Please enable JavaScript.";
    txt_please_wait = "Please wait. Search in progress...";
    txt_results_for = "Results for: ";
    
    
    </script><script type="application/javascript" src="https://code.jquery.com/jquery-1.4.3.min.js"></script><script type="application/javascript" src="/common/themes/pre-hdp-3.1/js/jquery-ui-1.8.2.custom.min.js"></script><script type="application/javascript" src="/common/themes/pre-hdp-3.1/js/jquery.cookie.js"></script><script type="application/javascript" src="/common/themes/pre-hdp-3.1/js/jquery.treeview.min.js"></script><link href="https://cdn.jsdelivr.net/qtip2/3.0.3/jquery.qtip.min.css" rel="stylesheet" type="text/css" media="screen, projection"><script src="https://cdnjs.cloudflare.com/ajax/libs/qtip2/3.0.3/jquery.qtip.min.js" type="application/javascript"></script><script type="application/javascript" src="/common/js/navigation.js"></script><script type="application/javascript" src="/common/themes/pre-hdp-3.1/js/main.js"></script><script type="application/javascript" src="/common/themes/pre-hdp-3.1/js/htmlFileList.js"></script><script type="application/javascript" src="/common/themes/pre-hdp-3.1/js/htmlFileInfoList.js"></script><script type="application/javascript" src="/common/themes/pre-hdp-3.1/js/nwSearchFnt.js"></script><script type="application/javascript" src="/common/themes/pre-hdp-3.1/js/en_stemmer.js"></script><script type="application/javascript" src="/common/themes/pre-hdp-3.1/js/index-1.js"></script><script type="application/javascript" src="/common/themes/pre-hdp-3.1/js/index-2.js"></script><script type="application/javascript" src="/common/themes/pre-hdp-3.1/js/index-3.js"></script><script type="application/javascript">
      
      
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-22950817-19', 'auto');
    ga('send', 'pageview');
    
    
    </script><script type="application/javascript" src="/common/themes/pre-hdp-3.1/js/plugins.js"></script><script type="application/javascript" src="/common/themes/pre-hdp-3.1/js/scripts.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.3.0/highlight.min.js" type="application/javascript"></script><script type="application/javascript">
      
    // PAGE SPECIFIC SCRIPTS
    
    $('.chapters>li .dropdown').click(function () {
    var $arrow = $(this).find('i.fa');
    if( $arrow.hasClass('fa-chevron-down')) {
    $(this).siblings('.sections').show();
    $arrow.removeClass('fa-chevron-down').addClass('fa-chevron-up');
    } else {
    console.log('up');
    $(this).siblings('.sections').hide();
    $arrow.removeClass('fa-chevron-up').addClass('fa-chevron-down');
    }
    });
    
    //  $('h3').on('mouseenter',function() {
    //      console.log('received mouseover');
    //      $(this).find('.hash-link').show();
    //  });
    
    //  $('h3').on('mouseleave',function() {
    //      $(this).find('.hash-link').hide();
    //  });
    
    
    // STICKY SIDEBARs
    var stickySidebar = $('.sticky');
    
    if (stickySidebar.length > 0) {
    var stickyHeight = stickySidebar.height(),
    sidebarTop = stickySidebar.offset().top;
    }
    
    // on scroll move the sidebar
    $(window).scroll(function () {
    if (stickySidebar.length > 0) {
    var scrollTop = $(window).scrollTop();
    console.log
    
    if (sidebarTop < scrollTop) {
    stickySidebar.css('top', scrollTop - sidebarTop);
    
    // stop the sticky sidebar at the footer to avoid overlapping
    var sidebarBottom = stickySidebar.offset().top + stickyHeight,
    stickyStop = $('.main-content').offset().top + $('.main-content').height();
    if (stickyStop < sidebarBottom) {
    var stopPosition = $('.main-content').height() - stickyHeight;
    stickySidebar.css('top', stopPosition);
    }
    }
    else {
    stickySidebar.css('top', '0');
    }
    }
    });
    
    $(window).resize(function () {
    if (stickySidebar.length > 0) {
    stickyHeight = stickySidebar.height();
    }
    });
    
    // Initialize Syntax Highlighting
    hljs.initHighlightingOnLoad();
    
    </script><style type="text/css">
      
      
    input {
    margin-bottom: 5px;
    margin-top: 2px;
    }
    
    .folder {
    display: block;
    height: 22px;
    padding-left: 20px;
    background: transparent url(/common/themes/pre-hdp-3.1/images/folder.gif) 0 0px no-repeat;
    }
    
    </style><link href="/common/themes/pre-hdp-3.1/images/favicon.ico" rel="icon" type="image/x-icon" sizes="16x16"><link href="https://hortonworks.com/wp-content/uploads/2016/04/cropped-favicon521x512-70x70.png" rel="icon" type="image/x-icon" sizes="32x32"><link href="https://hortonworks.com/wp-content/uploads/2016/04/cropped-favicon521x512-300x300.png" rel="icon" type="image/x-icon" sizes="192x192"><link href="https://hortonworks.com/wp-content/uploads/2016/04/cropped-favicon521x512-300x300.png" rel="apple-touch-icon-precomposed" type="image/x-icon" sizes="192x192"><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.3.0/styles/default.min.css" rel="stylesheet"><link rel="stylesheet" media="screen, projection" href="/common/themes/pre-hdp-3.1/css/main.css"><link rel="stylesheet" media="screen, projection" href="/common/themes/pre-hdp-3.1/css/docux.css"><style type="text/css"></style><link rel="stylesheet" type="text/css" media="screen, projection" href="/common/themes/pre-hdp-3.1/css/jquery-ui-1.8.2.custom.css"><link rel="stylesheet" type="text/css" media="screen, projection" href="/common/themes/pre-hdp-3.1/css/jquery.treeview.css"><link href="https://cdn.jsdelivr.net/qtip2/3.0.3/jquery.qtip.min.css" rel="stylesheet" type="text/css" media="screen, projection"></head><body class="docs books"><div id="body_container"><div class="breadcrumb_bg"><!-- --></div><div id="navbar"><section class="ps topstrip"><div><!-- --></div></section></div><div id="mainbody"><section class="ps titlebar"><div><div class="breadcrumb"><a href="/">Hortonworks Docs</a> » <a id="index_page" href="../../index.html">Cloudera Runtime 1.0.0</a> » <span class="current_book">Integrating Apache Hive with Spark and BI</span></div><div class="book_title">Integrating Apache Hive with Spark and BI</div><div class="ebooks"><div class="formats"><span class="desc">Also available as:</span><div class="format"><a onclick="_gaq.push(['_trackEvent', 'Header', 'pdfDownload', 'click', 1]);" title="Download a PDF of this document" class="pdficon" href="../cr-hive_integrating_hive_and_bi.pdf"><img src="/common/themes/pre-hdp-3.1/images/pdf.png" alt="PDF"></a></div></div></div></div></section><div class="lowerbody"><section class="ps doc-content"><div><div class="aside left"><div><div id="leftnavigation" style="padding-top:3px; background-color:white;"><div class="ui-tabs ui-widget ui-widget-content ui-corner-all"><div id="treeDiv" class="ui-tabs-panel ui-widget-content ui-corner-bottom"><img src="/common/themes/pre-hdp-3.1/images/loading.gif" alt="loading table of contents..." id="tocLoading" style="display:block;"><div id="ulTreeDiv" style="display:none" class="thisisthat"><ul id="tree" class="filetree"><li><a href="../topics/cr-hive_hivewarehouseconnector_for_handling_apache_spark_data.html">Hive Warehouse Connector for accessing Apache Spark data</a><ul><li><a href="../topics/cr-hive_apache_spark_hive_connection_configuration.html">Apache Spark-Apache Hive connection configuration</a></li><li><a href="../topics/cr-hive_submit_a_hivewarehouseconnector_app.html">Submit a Hive Warehouse Connector Scala or Java application</a></li><li><a href="../topics/cr-hive_submit_a_hivewarehouseconnector_python.html">Submit a Hive Warehouse Connector Python app</a></li><li><a href="../topics/cr-hive_hivewarehouseconnector_supported_types.html">Hive Warehouse Connector supported types</a></li><li><a href="../topics/cr-hive_hivewarehousesession_api_operations.html">HiveWarehouseSession API operations</a></li><li><a href="../topics/cr-hive_use_hwc_for_streaming.html">Use the Hive Warehouse Connector for streaming</a></li></ul></li><li><a href="../topics/cr-hive_query_sql_using_jdbcstoragehandler.html">Query a SQL data source using the JdbcStorageHandler</a></li></ul></div></div></div></div></div><div class="formats"><div class="pdf"><!-- --></div></div></div><div id="content" aria-labelledby="ariaid-title1">
 <h1 class="title topictitle1" id="ariaid-title1">Writing data to Kafka</h1>
 
 
 <div class="body conbody"><p class="shortdesc">You can extract, transform, and load a Hive table to a Kafka topic for real-time
  streaming of a large volume of Hive data. You need some understanding of write semantics and the
  metadata columns required for writing data to Kafka.</p>
  <section class="section"><h2 class="title sectiontitle">Write semantics</h2>
   
   <p class="p">The Hive-Kafka connector supports the following write semantics:</p>
   <ul class="ul">
    <li class="li"><code class="ph codeph">At least once </code>(default)</li>
    <li class="li"><code class="ph codeph">Exactly once</code></li>
    
   </ul>
   <dl class="dl">
    
     <dt class="dt dlterm">At least once (default)</dt>
     <dd class="dd">The default semantic. <code class="ph codeph">At least once</code> is the most common write semantic used
      by streaming engines. The internal Kafka producer retries on errors. If a message is not
      delivered, the exception is raised to the task level, which causes a restart, and more
      retries. The <code class="ph codeph">At least once</code> semantic leads to one of the following conclusions: <ul class="ul">
       <li class="li">If the job succeeds, each record is guaranteed to be delivered at least once. </li>
       <li class="li">If the job fails, some of the records might be lost and some might not be sent. <p class="p">In
         this case, you can retry the query, which eventually leads to the delivery of each record
         at least once.</p>
       </li>
      </ul></dd>
    
   </dl>
   <dl class="dl">
    
     <dt class="dt dlterm">Exactly once</dt>
     <dd class="dd">Following the <code class="ph codeph">exactly once</code> semantic, the Hive job ensures that either
      every record is delivered exactly once, or nothing is delivered. You can use only Kafka
      brokers supporting the Transaction API (0.11.0.x or later). To use this semantic, you must set
      the table property <code class="ph codeph">"kafka.write.semantic"="EXACTLY_ONCE"</code>. </dd>
    
   </dl> 
  </section>
 <section class="section"><h2 class="title sectiontitle">Metadata columns</h2>
  
  <p class="p">In addition to the user row payload, the insert statement must include values for the following
    extra columns:</p>
 <dl class="dl">
  
   <dt class="dt dlterm">__key</dt>
   <dd class="dd">Although you can set the value of this metadata column to null, using a meaningful key value
      to avoid unbalanced partitions is recommended. Any binary value is valid. </dd>
  
 </dl>
  <dl class="dl">
   
    <dt class="dt dlterm">__partition</dt>
    <dd class="dd">Use null unless you want to route the record to a particular partition. Using a nonexistent
      partition value results in an error.</dd>
   
  </dl>
  <dl class="dl">
   
    <dt class="dt dlterm">__offset</dt>
    <dd class="dd">You cannot set this value, which is fixed at <code class="ph codeph">-1</code>. </dd>
   
  </dl>
  <dl class="dl">
   
     <dt class="dt dlterm">__timestamp</dt>
     <dd class="dd">You can set this value to a meaningful timestamp, represented as the number of milliseconds
      since epoch. Optionally, you can set this value to <code class="ph codeph">null</code> or
       <code class="ph codeph">-1</code>, which means that the Kafka broker strategy sets the timestamp
      column.</dd>
    
  </dl>
 </section>
  
 </div>
<nav role="navigation" class="related-links"><div class="linklist relinfo"><strong>Related information</strong><br><div><a class="link" href="https://kafka.apache.org/0110/documentation.html" target="_blank">Apache Kafka Documentation</a></div></div></nav></div></div></section></div></div></div><section class="ps footer"><div><div class="copyright">© 2012–2019, Hortonworks, Inc.</div><div class="license">Document licensed under the <a href="https://creativecommons.org/licenses/by-sa/4.0/legalcode">Creative
          Commons Attribution ShareAlike 4.0 License</a>.</div><div class="menulinks"><a href="https://hortonworks.com">Hortonworks.com</a> | 
          <a href="#">Documentation</a> |
          <a href="https://hortonworks.com/support/">Support</a> |
          <a href="https://community.hortonworks.com/">Community</a></div></div></section></body></html>