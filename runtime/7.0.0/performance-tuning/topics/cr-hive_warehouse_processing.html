<html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="UTF-8"><meta name="DC.Type" content="concept"><meta name="description" content="A brief introduction to these software and systems, which affect performance, helps you understand the scope of the tuning task: HiveServer, admission control, batch processing using Apache Tez, interactive processing using Apache Tez and LLAP daemons, and YARN."><meta name="DC.subject" content="Hive, admission control, interactive processing, LLAP architecture"><meta name="keywords" content="Hive, admission control, interactive processing, LLAP architecture"><meta name="DC.Relation" scheme="URI" content="../topics/cr-hive_setup_multiple_hiveservers.html"><meta name="DC.Relation" scheme="URI" content="../topics/cr-hive_query_result_cache_ms_cache.html"><meta name="prodname" content="Cloudera Runtime"><meta name="version" content="1"><meta name="release" content="0"><meta name="modification" content="0"><meta name="brand" content="Cloudera Runtime"><meta name="rights" content="© 2019 Cloudera, Inc."><meta name="DC.Date.Created" content="2019-04-15"><meta name="DC.Date.Modified" content="2019-04-15"><meta name="DC.Format" content="XHTML"><meta name="DC.Identifier" content="hive_warehouse_processing"><link rel="stylesheet" type="text/css" href="../commonltr.css"><title>Key components of Hive warehouse processing</title><script type="application/javascript">
      
      
    //The id for tree cookie
    var treeCookieId = "treeview-bk_release-notes";
    var language = "en";
    var w = new Object();
    //Localization
    txt_filesfound = 'Results';
    txt_enter_at_least_1_char = "You must enter at least one character.";
    txt_browser_not_supported = "Please enable JavaScript.";
    txt_please_wait = "Please wait. Search in progress...";
    txt_results_for = "Results for: ";
    
    
    </script><script type="application/javascript" src="https://code.jquery.com/jquery-1.4.3.min.js"></script><script type="application/javascript" src="/common/themes/pre-hdp-3.1/js/jquery-ui-1.8.2.custom.min.js"></script><script type="application/javascript" src="/common/themes/pre-hdp-3.1/js/jquery.cookie.js"></script><script type="application/javascript" src="/common/themes/pre-hdp-3.1/js/jquery.treeview.min.js"></script><link href="https://cdn.jsdelivr.net/qtip2/3.0.3/jquery.qtip.min.css" rel="stylesheet" type="text/css" media="screen, projection"><script src="https://cdnjs.cloudflare.com/ajax/libs/qtip2/3.0.3/jquery.qtip.min.js" type="application/javascript"></script><script type="application/javascript" src="/common/js/navigation.js"></script><script type="application/javascript" src="/common/themes/pre-hdp-3.1/js/main.js"></script><script type="application/javascript" src="/common/themes/pre-hdp-3.1/js/htmlFileList.js"></script><script type="application/javascript" src="/common/themes/pre-hdp-3.1/js/htmlFileInfoList.js"></script><script type="application/javascript" src="/common/themes/pre-hdp-3.1/js/nwSearchFnt.js"></script><script type="application/javascript" src="/common/themes/pre-hdp-3.1/js/en_stemmer.js"></script><script type="application/javascript" src="/common/themes/pre-hdp-3.1/js/index-1.js"></script><script type="application/javascript" src="/common/themes/pre-hdp-3.1/js/index-2.js"></script><script type="application/javascript" src="/common/themes/pre-hdp-3.1/js/index-3.js"></script><script type="application/javascript">
      
      
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-22950817-19', 'auto');
    ga('send', 'pageview');
    
    
    </script><script type="application/javascript" src="/common/themes/pre-hdp-3.1/js/plugins.js"></script><script type="application/javascript" src="/common/themes/pre-hdp-3.1/js/scripts.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.3.0/highlight.min.js" type="application/javascript"></script><script type="application/javascript">
      
    // PAGE SPECIFIC SCRIPTS
    
    $('.chapters>li .dropdown').click(function () {
    var $arrow = $(this).find('i.fa');
    if( $arrow.hasClass('fa-chevron-down')) {
    $(this).siblings('.sections').show();
    $arrow.removeClass('fa-chevron-down').addClass('fa-chevron-up');
    } else {
    console.log('up');
    $(this).siblings('.sections').hide();
    $arrow.removeClass('fa-chevron-up').addClass('fa-chevron-down');
    }
    });
    
    //  $('h3').on('mouseenter',function() {
    //      console.log('received mouseover');
    //      $(this).find('.hash-link').show();
    //  });
    
    //  $('h3').on('mouseleave',function() {
    //      $(this).find('.hash-link').hide();
    //  });
    
    
    // STICKY SIDEBARs
    var stickySidebar = $('.sticky');
    
    if (stickySidebar.length > 0) {
    var stickyHeight = stickySidebar.height(),
    sidebarTop = stickySidebar.offset().top;
    }
    
    // on scroll move the sidebar
    $(window).scroll(function () {
    if (stickySidebar.length > 0) {
    var scrollTop = $(window).scrollTop();
    console.log
    
    if (sidebarTop < scrollTop) {
    stickySidebar.css('top', scrollTop - sidebarTop);
    
    // stop the sticky sidebar at the footer to avoid overlapping
    var sidebarBottom = stickySidebar.offset().top + stickyHeight,
    stickyStop = $('.main-content').offset().top + $('.main-content').height();
    if (stickyStop < sidebarBottom) {
    var stopPosition = $('.main-content').height() - stickyHeight;
    stickySidebar.css('top', stopPosition);
    }
    }
    else {
    stickySidebar.css('top', '0');
    }
    }
    });
    
    $(window).resize(function () {
    if (stickySidebar.length > 0) {
    stickyHeight = stickySidebar.height();
    }
    });
    
    // Initialize Syntax Highlighting
    hljs.initHighlightingOnLoad();
    
    </script><style type="text/css">
      
      
    input {
    margin-bottom: 5px;
    margin-top: 2px;
    }
    
    .folder {
    display: block;
    height: 22px;
    padding-left: 20px;
    background: transparent url(/common/themes/pre-hdp-3.1/images/folder.gif) 0 0px no-repeat;
    }
    
    </style><link href="/common/themes/pre-hdp-3.1/images/favicon.ico" rel="icon" type="image/x-icon" sizes="16x16"><link href="https://hortonworks.com/wp-content/uploads/2016/04/cropped-favicon521x512-70x70.png" rel="icon" type="image/x-icon" sizes="32x32"><link href="https://hortonworks.com/wp-content/uploads/2016/04/cropped-favicon521x512-300x300.png" rel="icon" type="image/x-icon" sizes="192x192"><link href="https://hortonworks.com/wp-content/uploads/2016/04/cropped-favicon521x512-300x300.png" rel="apple-touch-icon-precomposed" type="image/x-icon" sizes="192x192"><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.3.0/styles/default.min.css" rel="stylesheet"><link rel="stylesheet" media="screen, projection" href="/common/themes/pre-hdp-3.1/css/main.css"><link rel="stylesheet" media="screen, projection" href="/common/themes/pre-hdp-3.1/css/docux.css"><style type="text/css"></style><link rel="stylesheet" type="text/css" media="screen, projection" href="/common/themes/pre-hdp-3.1/css/jquery-ui-1.8.2.custom.css"><link rel="stylesheet" type="text/css" media="screen, projection" href="/common/themes/pre-hdp-3.1/css/jquery.treeview.css"><link href="https://cdn.jsdelivr.net/qtip2/3.0.3/jquery.qtip.min.css" rel="stylesheet" type="text/css" media="screen, projection"></head><body class="docs books"><div id="body_container"><div class="breadcrumb_bg"><!-- --></div><div id="navbar"><section class="ps topstrip"><div><!-- --></div></section></div><div id="mainbody"><section class="ps titlebar"><div><div class="breadcrumb"><a href="/">Hortonworks Docs</a> » <a id="index_page" href="../../index.html">Cloudera Runtime 1.0.0</a> » <span class="current_book">Apache Hive Performance Tuning</span></div><div class="book_title">Apache Hive Performance Tuning</div><div class="ebooks"><div class="formats"><span class="desc">Also available as:</span><div class="format"><a onclick="_gaq.push(['_trackEvent', 'Header', 'pdfDownload', 'click', 1]);" title="Download a PDF of this document" class="pdficon" href="../cr-hive_performance_tuning.pdf"><img src="/common/themes/pre-hdp-3.1/images/pdf.png" alt="PDF"></a></div></div></div></div></section><div class="lowerbody"><section class="ps doc-content"><div><div class="aside left"><div><div id="leftnavigation" style="padding-top:3px; background-color:white;"><div class="ui-tabs ui-widget ui-widget-content ui-corner-all"><div id="treeDiv" class="ui-tabs-panel ui-widget-content ui-corner-bottom"><img src="/common/themes/pre-hdp-3.1/images/loading.gif" alt="loading table of contents..." id="tocLoading" style="display:block;"><div id="ulTreeDiv" style="display:none" class="thisisthat"><ul id="tree" class="filetree"><li><a href="../topics/cr-hive_optimizing_data_warehouse.html">Optimizing an Apache Hive data warehouse</a></li><li><a href="../topics/cr-hive_prepare_to_tune_performance.html">Preparations for tuning performance</a></li><li><a href="../topics/cr-hive_setting_up_llap.html">Setting up LLAP</a><ul><li><a href="../topics/cr-hive_enable_yarn_preemption.html">Enable YARN preemption</a></li><li><a href="../topics/cr-hive_enable_interactive_query.html">Enable interactive query</a></li><li><a href="../topics/cr-hive_setup_multiple_hsi.html">Set up multiple HiveServer Interactives for high availability</a></li><li><a href="../topics/cr-hive_configure_llap_queue.html">Configure an llap queue</a></li><li><a href="../topics/cr-hive_llap_add_proxy.html">Add a Hive proxy</a></li><li><a href="../topics/cr-hive_setup_llap.html">Configure other LLAP properties</a></li><li><a href="../topics/cr-hive_hiveserver_heap_sizing.html">Configure the HiveServer heap size</a></li><li><a href="../topics/cr-hive_save_llap_restart.html">Save LLAP settings and restart services</a></li><li><a href="../topics/cr-hive_run_llap_query.html">Run an interactive query</a></li></ul></li><li><a href="../topics/cr-hive_llap_parameters.html">LLAP and HiveServer Interactive properties</a></li><li><a href="../topics/cr-hive_use_hiveserver_interactive.html">Use HiveServer Interactive UI</a></li><li><a href="../topics/cr-hive_connect_clients_to_llap.html">Connect a JDBC client to LLAP</a></li><li><a href="../topics/cr-hive_configuring_yarn_queues.html">Configuring YARN queues for Hive</a><ul><li><a href="../topics/cr-hive_configure_queue_for_batch.html">Configure a queue for batch processing</a></li><li><a href="../topics/cr-hive_configure_custom_llap_queue.html">Configure a custom LLAP queue</a></li></ul></li><li><a href="../topics/cr-hive_setup_multiple_hiveservers.html">Set up multiple HiveServer instances</a></li><li class="active"><a href="../topics/cr-hive_warehouse_processing.html">Key components of Hive warehouse processing</a></li><li><a href="../topics/cr-hive_query_result_cache_ms_cache.html">Query result cache and metastore cache</a></li><li><a href="../topics/cr-hive_tez_engine_properties.html">Tez execution engine properties</a></li><li><a href="../topics/cr-hive_monitoring_performance.html">Monitoring Apache Hive performance</a><ul><li><a href="../topics/cr-hive_monitor_llap_resources.html">Monitoring LLAP resources</a></li></ul></li><li><a href="../topics/cr-hive_maximize_storage_resources_using_orc.html">Maximizing storage resources using ORC</a><ul><li><a href="../topics/cr-hive_advanced_orc_properties.html">Advanced ORC properties</a></li></ul></li><li><a href="../topics/cr-hive_improving_performance_using_partitions.html">Improving performance using partitions</a></li><li><a href="../topics/cr-hive_bucketed_tables.html">Handling bucketed tables</a></li><li><a href="../topics/cr-hive_cost_based_optimizer_overview.html">Improving performance using the cost-based optimizer</a><ul><li><a href="../topics/cr-hive_set_up_cbo_and_stats.html">Set up the cost-based optimizer and statistics</a></li><li><a href="../topics/cr-hive_generate_hive_statistics.html">Generate and view Apache Hive statistics</a></li><li><a href="../topics/cr-hive_statistics_generation_and_viewing_commands.html">Statistics generation and viewing commands</a></li><li><a href="../topics/cr-hive_optimization_and_planning_properties.html">Optimization and planning properties</a></li></ul></li></ul></div></div></div></div></div><div class="formats"><div class="pdf"><!-- --></div></div></div><div class="next-prev-links"><span class="previouslink"><a class="link" href="../topics/cr-hive_setup_multiple_hiveservers.html" title="You can set up HiveServer instances, which can share the same metastore database for different purposes, such as ETL, running multiple applications using different settings, or load-balancing using ZooKeeper.">Prev</a></span><span class="nextlink"><a class="link" href="../topics/cr-hive_query_result_cache_ms_cache.html" title="You need to understand the query result cache to enable or disable it for debugging and to configure the memory allocated for the results. You also need to understand how the metadata cache affects data consistency.">Next</a></span></div><div id="content" aria-labelledby="ariaid-title1">
 <h1 class="title topictitle1" id="ariaid-title1">Key components of Hive warehouse processing</h1>
 
 
 <div class="body conbody"><p class="shortdesc">A brief introduction to these software and systems, which affect performance, helps
  you understand the scope of the tuning task: HiveServer, admission control, batch processing using
  Apache Tez, interactive processing using Apache Tez and LLAP daemons, and YARN.</p>
  <section class="section"><h2 class="title sectiontitle">HiveServer</h2>
   
   <p class="p">HiveServer provides Hive service to multiple clients that simultaneously execute queries
    against Hive using an open API driver, such as JDBC or ODBC. For optimal performance, you should
    use HiveServer to connect your client application and the Hive enterprise data warehouse (EDW).
    Using Ambari, you can install, configure, and monitor the Hive service and HiveServer. </p>
   <p class="p">An embedded metastore, which is different from MetastoreDB, runs in HiveServer and performs
    the following tasks:</p>
   <ul class="ul">
    <li class="li"> Gets statistics and schema from  MetastoreDB</li>
    <li class="li"> Compiles queries</li>
    <li class="li"> Generates query execution plans</li>
    <li class="li"> Submits query execution plans </li>
    <li class="li"> Returns query results to the client </li>
   </ul>
  </section>
  <section class="section"><h2 class="title sectiontitle">Admission control</h2>
   
   <p class="p">HiveServer coordinates admission control. Admission control is critical to Hive performance
    tuning. Admission control manages queries in a manner similar to how connection pooling manages
    network connections in RDBMS databases. When using the Hive LLAP on the Tez engine, you can
    configure admission control. </p>
   <div class="p">Admission control performs the following functions: <ul class="ul" id="hive_warehouse_processing__ul_aqf_ltq_1fb">
     <li class="li">Enables optimal Hive performance when multiple user sessions generate asynchronous threads
      simultaneously</li>
     <li class="li">Scales concurrent queries to suit system resources and
      demand</li>
     <li class="li">Postpones processing or cancels other queries if
      necessary&gt;</li>
    </ul></div>
  </section>
  <section class="section"><h2 class="title sectiontitle">Batch processing using Apache Tez</h2>
   
   <p class="p">Each queue must have the capacity to support one complete Tez application, as defined by its
    Application Master (AM) (tez.am.resource.memory.mb property). Consequently, the number of Apache Tez AMs limits the
    maximum number of queries a cluster can run concurrently. A Hive-based analytic application
    relies on YARN containers as execution resources. The Hive configuration defines containers. The
    number and longevity of containers that reside in your environment depend on whether you want to
    run with batch workloads or enable Hive LLAP in HDP. </p>
   <p class="p">Hive on Tez is an advancement over earlier application frameworks for Hadoop data processing,
    such as using Hive on MapReduce, which is not supported in HDP 3.0 and later. The Tez framework
    is suitable for high-performance batch workloads. </p>
   <p class="p">After query compilation, HiveServer generates a Tez graph that is submitted to YARN. A Tez
    AM monitors the query as it runs. </p>
  </section>
  <section class="section"><h2 class="title sectiontitle">Interactive processing using Apache Tez and LLAP daemons</h2>
   
   <p class="p">The way interactive and batch workloads operate with YARN and queues differs. Hive LLAP
    manages resources globally, rather than managing resources of each Tez session independently.
    LLAP does not rely on YARN: LLAP has its own resource scheduling and pre-emption built in.
    Consequently, you need only a single queue to manage all LLAP resources. Each LLAP daemon runs
    as a single YARN container. </p>
   <p class="p">The following diagram shows the architecture of Hive LLAP:</p>
   <figure class="fig fignone">
    <img class="image" id="hive_warehouse_processing__image_y2m_b4m_r2b" src="../images/cr-hive2-llap-architecture-diagram.png">
   </figure>
   <dl class="dl">
    
     <dt class="dt dlterm">Query coordinators</dt>
     <dd class="dd">Components that coordinate the execution of a single, persistent LLAP
      daemon, typically one per node. This is the main differentiating component of the architecture,
      which enables faster query runtimes than earlier execution engines.</dd>
    
   </dl>
   <dl class="dl">
    
     <dt class="dt dlterm">Query executors</dt>
     <dd class="dd">Threads running inside the LLAP daemon. </dd>
    
   </dl>
 <dl class="dl">
  
   <dt class="dt dlterm">In-memory cache</dt>
   <dd class="dd">A cache inside the LLAP daemon that is shared across all users.</dd>
  
 </dl>
  
  </section>
  <section class="section"><h2 class="title sectiontitle">YARN</h2>
   
   <p class="p">LLAP depends on YARN queues. HiveServer and YARN work together to intelligently queue incoming
    queries of a Hive data set. The queuing process tends to minimize the latency of returned
    results. The LLAP daemons manage resources across YARN nodes. When you set up LLAP, you enable
    interactive queries, enable YARN pre-emption, and choose a YARN queue for LLAP processing. </p>
  </section>
 </div>
<nav role="navigation" class="related-links"><div class="familylinks"></div></nav></div></div></section></div></div></div><section class="ps footer"><div><div class="copyright">© 2012–2019, Hortonworks, Inc.</div><div class="license">Document licensed under the <a href="https://creativecommons.org/licenses/by-sa/4.0/legalcode">Creative
          Commons Attribution ShareAlike 4.0 License</a>.</div><div class="menulinks"><a href="https://hortonworks.com">Hortonworks.com</a> | 
          <a href="#">Documentation</a> |
          <a href="https://hortonworks.com/support/">Support</a> |
          <a href="https://community.hortonworks.com/">Community</a></div></div></section></body></html>