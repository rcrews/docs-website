<html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="UTF-8"><meta name="DC.Type" content="task"><meta name="description" content="Configuring LLAP involves setting properties in YARN and Hive. After you configure the llap queue, you need to go back to the Hive configuration to continue setting up low-latency analytical processing (LLAP)."><meta name="DC.subject" content="Hive, LLAP setup, interactive query, performance tuning"><meta name="keywords" content="Hive, LLAP setup, interactive query, performance tuning"><meta name="DC.Relation" scheme="URI" content="../topics/cr-hive_setting_up_llap.html"><meta name="DC.Relation" scheme="URI" content="../topics/cr-hive_llap_add_proxy.html"><meta name="DC.Relation" scheme="URI" content="../topics/cr-hive_hiveserver_heap_sizing.html"><meta name="prodname" content="Cloudera Runtime"><meta name="version" content="1"><meta name="release" content="0"><meta name="modification" content="0"><meta name="brand" content="Cloudera Runtime"><meta name="rights" content="© 2019 Cloudera, Inc."><meta name="DC.Date.Created" content="2019-04-15"><meta name="DC.Date.Modified" content="2019-04-15"><meta name="DC.Format" content="XHTML"><meta name="DC.Identifier" content="hive_setup_llap"><link rel="stylesheet" type="text/css" href="../commonltr.css"><title>Configure other LLAP properties</title><script type="application/javascript">
      
      
    //The id for tree cookie
    var treeCookieId = "treeview-bk_release-notes";
    var language = "en";
    var w = new Object();
    //Localization
    txt_filesfound = 'Results';
    txt_enter_at_least_1_char = "You must enter at least one character.";
    txt_browser_not_supported = "Please enable JavaScript.";
    txt_please_wait = "Please wait. Search in progress...";
    txt_results_for = "Results for: ";
    
    
    </script><script type="application/javascript" src="https://code.jquery.com/jquery-1.4.3.min.js"></script><script type="application/javascript" src="/common/themes/pre-hdp-3.1/js/jquery-ui-1.8.2.custom.min.js"></script><script type="application/javascript" src="/common/themes/pre-hdp-3.1/js/jquery.cookie.js"></script><script type="application/javascript" src="/common/themes/pre-hdp-3.1/js/jquery.treeview.min.js"></script><link href="https://cdn.jsdelivr.net/qtip2/3.0.3/jquery.qtip.min.css" rel="stylesheet" type="text/css" media="screen, projection"><script src="https://cdnjs.cloudflare.com/ajax/libs/qtip2/3.0.3/jquery.qtip.min.js" type="application/javascript"></script><script type="application/javascript" src="/common/js/navigation.js"></script><script type="application/javascript" src="/common/themes/pre-hdp-3.1/js/main.js"></script><script type="application/javascript" src="/common/themes/pre-hdp-3.1/js/htmlFileList.js"></script><script type="application/javascript" src="/common/themes/pre-hdp-3.1/js/htmlFileInfoList.js"></script><script type="application/javascript" src="/common/themes/pre-hdp-3.1/js/nwSearchFnt.js"></script><script type="application/javascript" src="/common/themes/pre-hdp-3.1/js/en_stemmer.js"></script><script type="application/javascript" src="/common/themes/pre-hdp-3.1/js/index-1.js"></script><script type="application/javascript" src="/common/themes/pre-hdp-3.1/js/index-2.js"></script><script type="application/javascript" src="/common/themes/pre-hdp-3.1/js/index-3.js"></script><script type="application/javascript">
      
      
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-22950817-19', 'auto');
    ga('send', 'pageview');
    
    
    </script><script type="application/javascript" src="/common/themes/pre-hdp-3.1/js/plugins.js"></script><script type="application/javascript" src="/common/themes/pre-hdp-3.1/js/scripts.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.3.0/highlight.min.js" type="application/javascript"></script><script type="application/javascript">
      
    // PAGE SPECIFIC SCRIPTS
    
    $('.chapters>li .dropdown').click(function () {
    var $arrow = $(this).find('i.fa');
    if( $arrow.hasClass('fa-chevron-down')) {
    $(this).siblings('.sections').show();
    $arrow.removeClass('fa-chevron-down').addClass('fa-chevron-up');
    } else {
    console.log('up');
    $(this).siblings('.sections').hide();
    $arrow.removeClass('fa-chevron-up').addClass('fa-chevron-down');
    }
    });
    
    //  $('h3').on('mouseenter',function() {
    //      console.log('received mouseover');
    //      $(this).find('.hash-link').show();
    //  });
    
    //  $('h3').on('mouseleave',function() {
    //      $(this).find('.hash-link').hide();
    //  });
    
    
    // STICKY SIDEBARs
    var stickySidebar = $('.sticky');
    
    if (stickySidebar.length > 0) {
    var stickyHeight = stickySidebar.height(),
    sidebarTop = stickySidebar.offset().top;
    }
    
    // on scroll move the sidebar
    $(window).scroll(function () {
    if (stickySidebar.length > 0) {
    var scrollTop = $(window).scrollTop();
    console.log
    
    if (sidebarTop < scrollTop) {
    stickySidebar.css('top', scrollTop - sidebarTop);
    
    // stop the sticky sidebar at the footer to avoid overlapping
    var sidebarBottom = stickySidebar.offset().top + stickyHeight,
    stickyStop = $('.main-content').offset().top + $('.main-content').height();
    if (stickyStop < sidebarBottom) {
    var stopPosition = $('.main-content').height() - stickyHeight;
    stickySidebar.css('top', stopPosition);
    }
    }
    else {
    stickySidebar.css('top', '0');
    }
    }
    });
    
    $(window).resize(function () {
    if (stickySidebar.length > 0) {
    stickyHeight = stickySidebar.height();
    }
    });
    
    // Initialize Syntax Highlighting
    hljs.initHighlightingOnLoad();
    
    </script><style type="text/css">
      
      
    input {
    margin-bottom: 5px;
    margin-top: 2px;
    }
    
    .folder {
    display: block;
    height: 22px;
    padding-left: 20px;
    background: transparent url(/common/themes/pre-hdp-3.1/images/folder.gif) 0 0px no-repeat;
    }
    
    </style><link href="/common/themes/pre-hdp-3.1/images/favicon.ico" rel="icon" type="image/x-icon" sizes="16x16"><link href="https://hortonworks.com/wp-content/uploads/2016/04/cropped-favicon521x512-70x70.png" rel="icon" type="image/x-icon" sizes="32x32"><link href="https://hortonworks.com/wp-content/uploads/2016/04/cropped-favicon521x512-300x300.png" rel="icon" type="image/x-icon" sizes="192x192"><link href="https://hortonworks.com/wp-content/uploads/2016/04/cropped-favicon521x512-300x300.png" rel="apple-touch-icon-precomposed" type="image/x-icon" sizes="192x192"><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.3.0/styles/default.min.css" rel="stylesheet"><link rel="stylesheet" media="screen, projection" href="/common/themes/pre-hdp-3.1/css/main.css"><link rel="stylesheet" media="screen, projection" href="/common/themes/pre-hdp-3.1/css/docux.css"><style type="text/css"></style><link rel="stylesheet" type="text/css" media="screen, projection" href="/common/themes/pre-hdp-3.1/css/jquery-ui-1.8.2.custom.css"><link rel="stylesheet" type="text/css" media="screen, projection" href="/common/themes/pre-hdp-3.1/css/jquery.treeview.css"><link href="https://cdn.jsdelivr.net/qtip2/3.0.3/jquery.qtip.min.css" rel="stylesheet" type="text/css" media="screen, projection"></head><body class="docs books"><div id="body_container"><div class="breadcrumb_bg"><!-- --></div><div id="navbar"><section class="ps topstrip"><div><!-- --></div></section></div><div id="mainbody"><section class="ps titlebar"><div><div class="breadcrumb"><a href="/">Hortonworks Docs</a> » <a id="index_page" href="../../index.html">Cloudera Runtime 1.0.0</a> » <span class="current_book">Apache Hive Performance Tuning</span></div><div class="book_title">Apache Hive Performance Tuning</div><div class="ebooks"><div class="formats"><span class="desc">Also available as:</span><div class="format"><a onclick="_gaq.push(['_trackEvent', 'Header', 'pdfDownload', 'click', 1]);" title="Download a PDF of this document" class="pdficon" href="../cr-hive_performance_tuning.pdf"><img src="/common/themes/pre-hdp-3.1/images/pdf.png" alt="PDF"></a></div></div></div></div></section><div class="lowerbody"><section class="ps doc-content"><div><div class="aside left"><div><div id="leftnavigation" style="padding-top:3px; background-color:white;"><div class="ui-tabs ui-widget ui-widget-content ui-corner-all"><div id="treeDiv" class="ui-tabs-panel ui-widget-content ui-corner-bottom"><img src="/common/themes/pre-hdp-3.1/images/loading.gif" alt="loading table of contents..." id="tocLoading" style="display:block;"><div id="ulTreeDiv" style="display:none" class="thisisthat"><ul id="tree" class="filetree"><li><a href="../topics/cr-hive_optimizing_data_warehouse.html">Optimizing an Apache Hive data warehouse</a></li><li><a href="../topics/cr-hive_prepare_to_tune_performance.html">Preparations for tuning performance</a></li><li><a href="../topics/cr-hive_setting_up_llap.html">Setting up LLAP</a><ul><li><a href="../topics/cr-hive_enable_yarn_preemption.html">Enable YARN preemption</a></li><li><a href="../topics/cr-hive_enable_interactive_query.html">Enable interactive query</a></li><li><a href="../topics/cr-hive_setup_multiple_hsi.html">Set up multiple HiveServer Interactives for high availability</a></li><li><a href="../topics/cr-hive_configure_llap_queue.html">Configure an llap queue</a></li><li><a href="../topics/cr-hive_llap_add_proxy.html">Add a Hive proxy</a></li><li class="active"><a href="../topics/cr-hive_setup_llap.html">Configure other LLAP properties</a></li><li><a href="../topics/cr-hive_hiveserver_heap_sizing.html">Configure the HiveServer heap size</a></li><li><a href="../topics/cr-hive_save_llap_restart.html">Save LLAP settings and restart services</a></li><li><a href="../topics/cr-hive_run_llap_query.html">Run an interactive query</a></li></ul></li><li><a href="../topics/cr-hive_llap_parameters.html">LLAP and HiveServer Interactive properties</a></li><li><a href="../topics/cr-hive_use_hiveserver_interactive.html">Use HiveServer Interactive UI</a></li><li><a href="../topics/cr-hive_connect_clients_to_llap.html">Connect a JDBC client to LLAP</a></li><li><a href="../topics/cr-hive_configuring_yarn_queues.html">Configuring YARN queues for Hive</a><ul><li><a href="../topics/cr-hive_configure_queue_for_batch.html">Configure a queue for batch processing</a></li><li><a href="../topics/cr-hive_configure_custom_llap_queue.html">Configure a custom LLAP queue</a></li></ul></li><li><a href="../topics/cr-hive_setup_multiple_hiveservers.html">Set up multiple HiveServer instances</a></li><li><a href="../topics/cr-hive_warehouse_processing.html">Key components of Hive warehouse processing</a></li><li><a href="../topics/cr-hive_query_result_cache_ms_cache.html">Query result cache and metastore cache</a></li><li><a href="../topics/cr-hive_tez_engine_properties.html">Tez execution engine properties</a></li><li><a href="../topics/cr-hive_monitoring_performance.html">Monitoring Apache Hive performance</a><ul><li><a href="../topics/cr-hive_monitor_llap_resources.html">Monitoring LLAP resources</a></li></ul></li><li><a href="../topics/cr-hive_maximize_storage_resources_using_orc.html">Maximizing storage resources using ORC</a><ul><li><a href="../topics/cr-hive_advanced_orc_properties.html">Advanced ORC properties</a></li></ul></li><li><a href="../topics/cr-hive_improving_performance_using_partitions.html">Improving performance using partitions</a></li><li><a href="../topics/cr-hive_bucketed_tables.html">Handling bucketed tables</a></li><li><a href="../topics/cr-hive_cost_based_optimizer_overview.html">Improving performance using the cost-based optimizer</a><ul><li><a href="../topics/cr-hive_set_up_cbo_and_stats.html">Set up the cost-based optimizer and statistics</a></li><li><a href="../topics/cr-hive_generate_hive_statistics.html">Generate and view Apache Hive statistics</a></li><li><a href="../topics/cr-hive_statistics_generation_and_viewing_commands.html">Statistics generation and viewing commands</a></li><li><a href="../topics/cr-hive_optimization_and_planning_properties.html">Optimization and planning properties</a></li></ul></li></ul></div></div></div></div></div><div class="formats"><div class="pdf"><!-- --></div></div></div><div class="next-prev-links"><span class="previouslink"><a class="link" href="../topics/cr-hive_llap_add_proxy.html" title="To prevent network connection or notification problems, you must add a hive user proxy for HiveServer Interactive service to access the Hive Metastore.">Prev</a></span><span class="nextlink"><a class="link" href="../topics/cr-hive_hiveserver_heap_sizing.html" title="Generally, configuring HiveServer heap memory according to the recommendations in this topic ensures proper LLAP functioning. If HiveServer heap memory is set too low, HiveServer Interactive keeps going down.">Next</a></span></div><div id="content" aria-labelledby="ariaid-title1">
    <h1 class="title topictitle1" id="ariaid-title1">Configure other LLAP properties</h1>
    
    
    <div class="body taskbody"><p class="shortdesc">Configuring LLAP involves setting properties in YARN and Hive. After you configure
        the llap queue, you need to go back to the Hive configuration to continue setting up
        low-latency analytical processing (LLAP).  </p>
        <section class="section context">
            <p class="p">In this task, you accept the Ambari configuration of a number of properties or
                reconfigure the properties. Ambari generally configures the number of nodes that run
                an LLAP daemon and total concurrent queries depending on the size of the llap queue.
                Ambari also attempts to correctly configure the following properties for your
                particular cluster:</p><dl class="dl">
                
                    <dt class="dt dlterm">Memory per Daemon</dt>
                    <dd class="dd">YARN container size for each daemon (MB)</dd>
                
            </dl>
            <dl class="dl">
                
                    <dt class="dt dlterm">In-Memory Cache per Daemon</dt>
                    <dd class="dd">Size of the cache in each container (MB)</dd>
                
            </dl>
            <dl class="dl">
                
                    <dt class="dt dlterm">Number of executors per LLAP Daemon</dt>
                    <dd class="dd">The number of fragments that can execute in parallel on a daemon</dd>
                
            </dl>Use the slider controls to change or restore settings: <figure class="fig fignone"><img class="image" id="hive_setup_llap__image_nfb_qfr_vgb" src="../images/cr-hive_configs_controls.png"></figure>To set the value
            outside the slider range, you move your pointer over the field to enable the hover
            actions, and select Override. </section>
        <ol class="ol steps"><li class="li step stepexpand">
                <span class="ph cmd">Accept or change the Number of Nodes Used By Hive LLAP
                        (<code class="ph codeph">num_llap_nodes_for_llap_daemons</code> property). For example,
                    accept using 2 nodes for LLAP.</span>
                <div class="itemgroup stepxmp">
                    <figure class="fig fignone">
                        <img class="image" id="hive_setup_llap__image_ips_v4y_r2b" src="../images/cr-hive_num_nodes_interactive_query.png">
                    </figure>
                </div>
            </li><li class="li step stepexpand">
                <span class="ph cmd">Accept the Maximum Total Concurrent Queries
                        (<code class="ph codeph">hive.server2.tez.sessions.per.default.queue</code> property), or
                    make changes.</span>
            </li><li class="li step stepexpand">
                <span class="ph cmd">Check Memory per Daemon (<code class="ph codeph">hive.llap.daemon.yarn.container.mb</code>
                    property) and In-Memory Cache per Daemon
                        (<code class="ph codeph">hive.llap.io.memory.size</code> property).</span>
                <div class="itemgroup stepxmp">
                    <figure class="fig fignone">
                        <img class="image" id="hive_setup_llap__image_ty5_lpy_r2b" src="../images/cr-hive_other_interactive_query.png">
                    </figure>
                </div>
                <div class="itemgroup info">This memory (<code class="ph codeph">hive.llap.daemon.yarn.container.mb</code>) plus the
                    cache (<code class="ph codeph">hive.llap.io.memory.size</code>) must fit within the container
                    size specified for the YARN container. The YARN container configuration setting
                    appears in <span class="ph menucascade"><span class="ph uicontrol">Services</span><abbr title="and then"> &gt; </abbr><span class="ph uicontrol">YARN</span><abbr title="and then"> &gt; </abbr><span class="ph uicontrol">Configs</span><abbr title="and then"> &gt; </abbr><span class="ph uicontrol">Settings</span></span>.</div>
            </li><li class="li step stepexpand">
                <span class="ph cmd">Accept the Number of Executors per LLAP Daemon
                        (<code class="ph codeph">hive.llap.daemon.num.executors</code>), or change this setting if
                    you know what you are doing, and check that the
                        <code class="ph codeph">hive.llap.io.threadpool.size</code> is the same value. </span>
            </li><li class="li step stepexpand">
                <span class="ph cmd">Save any Hive configuration changes, and in <span class="ph menucascade"><span class="ph uicontrol">Services</span><abbr title="and then"> &gt; </abbr><span class="ph uicontrol">YARN</span><abbr title="and then"> &gt; </abbr><span class="ph uicontrol">Settings</span><abbr title="and then"> &gt; </abbr><span class="ph uicontrol">Memory - Node</span></span>, check that the Minimum Container Size (Memory) for YARN is
                    low.</span>
                <div class="itemgroup info">The value should rarely exceed 1024 MB.</div>
            </li><li class="li step stepexpand">
                <span class="ph cmd">Set the Maximum Container Size (Memory) to the same value as the 
                    Memory Allocated for All YARN Containers on a Node.</span>
                <div class="itemgroup stepxmp">
                    <figure class="fig fignone">
                        <img class="image" id="hive_setup_llap__image_wzc_zrl_vgb" src="../images/cr-hive_yarn_container.png">
                    </figure>
                </div>
            </li><li class="li step stepexpand">
                <span class="ph cmd">In Ambari, select <span class="ph menucascade"><span class="ph uicontrol">Services</span><abbr title="and then"> &gt; </abbr><span class="ph uicontrol">YARN</span><abbr title="and then"> &gt; </abbr><span class="ph uicontrol">Configs</span><abbr title="and then"> &gt; </abbr><span class="ph uicontrol">Advanced</span></span>.</span>
            </li><li class="li step stepexpand">
                <span class="ph cmd">In Custom yarn-site, add the following properties unless, upon attempting to
                    add these properties, Ambari indicates the properties are already
                        added:<code class="ph codeph">yarn.resourcemanager.monitor.capacity.preemption.natural_termination_factor</code>
                    (value = 1) and
                        <code class="ph codeph">yarn.resourcemanager.monitor.capacity.preemption.total_preemption_per_round</code>
                    (as described below).</span>
                <div class="itemgroup info">Calculate the value of the total preemption per round by dividing 1 by the
                    number of cluster nodes. Enter the value as a decimal. </div>
                <div class="itemgroup stepxmp">For example, if your cluster has 20 nodes, then divide 1 by 20 and enter
                    0.05 as the value of this property setting.</div>
            </li><li class="li step stepexpand">
                <span class="ph cmd">Save YARN changes, and go back to the Hive configuration.</span>
            </li></ol>
    </div>
<nav role="navigation" class="related-links"><div class="familylinks"><div class="parentlink"><strong>Parent topic:</strong> <a class="link" href="../topics/cr-hive_setting_up_llap.html" title="Using Ambari, you can set up basic, low-latency analytical processing (LLAP) by accepting the default llap queue, changing some YARN queue properties, and adding a HiveServer property to hive-site.xml.">Setting up LLAP</a></div></div></nav></div></div></section></div></div></div><section class="ps footer"><div><div class="copyright">© 2012–2019, Hortonworks, Inc.</div><div class="license">Document licensed under the <a href="https://creativecommons.org/licenses/by-sa/4.0/legalcode">Creative
          Commons Attribution ShareAlike 4.0 License</a>.</div><div class="menulinks"><a href="https://hortonworks.com">Hortonworks.com</a> | 
          <a href="#">Documentation</a> |
          <a href="https://hortonworks.com/support/">Support</a> |
          <a href="https://community.hortonworks.com/">Community</a></div></div></section></body></html>