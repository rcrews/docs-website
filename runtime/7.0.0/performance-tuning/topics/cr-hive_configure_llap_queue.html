<html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="UTF-8"><meta name="DC.Type" content="task"><meta name="description" content="Ambari generally creates and configures an interactive query queue named llap and points the Hive service to a YARN queue. You check, and if necessary, change the llap queue using YARN Queue Manager."><meta name="DC.subject" content="Hive, LLAP setup, interactive query, custom YARN site"><meta name="keywords" content="Hive, LLAP setup, interactive query, custom YARN site"><meta name="DC.Relation" scheme="URI" content="../topics/cr-hive_setting_up_llap.html"><meta name="DC.Relation" scheme="URI" content="../topics/cr-hive_setup_multiple_hsi.html"><meta name="DC.Relation" scheme="URI" content="../topics/cr-hive_llap_add_proxy.html"><meta name="prodname" content="Cloudera Runtime"><meta name="version" content="1"><meta name="release" content="0"><meta name="modification" content="0"><meta name="brand" content="Cloudera Runtime"><meta name="rights" content="© 2019 Cloudera, Inc."><meta name="DC.Date.Created" content="2019-04-15"><meta name="DC.Date.Modified" content="2019-04-15"><meta name="DC.Format" content="XHTML"><meta name="DC.Identifier" content="hive_configure_llap_queue"><link rel="stylesheet" type="text/css" href="../commonltr.css"><title>Configure an llap queue</title><script type="application/javascript">
      
      
    //The id for tree cookie
    var treeCookieId = "treeview-bk_release-notes";
    var language = "en";
    var w = new Object();
    //Localization
    txt_filesfound = 'Results';
    txt_enter_at_least_1_char = "You must enter at least one character.";
    txt_browser_not_supported = "Please enable JavaScript.";
    txt_please_wait = "Please wait. Search in progress...";
    txt_results_for = "Results for: ";
    
    
    </script><script type="application/javascript" src="https://code.jquery.com/jquery-1.4.3.min.js"></script><script type="application/javascript" src="/common/themes/pre-hdp-3.1/js/jquery-ui-1.8.2.custom.min.js"></script><script type="application/javascript" src="/common/themes/pre-hdp-3.1/js/jquery.cookie.js"></script><script type="application/javascript" src="/common/themes/pre-hdp-3.1/js/jquery.treeview.min.js"></script><link href="https://cdn.jsdelivr.net/qtip2/3.0.3/jquery.qtip.min.css" rel="stylesheet" type="text/css" media="screen, projection"><script src="https://cdnjs.cloudflare.com/ajax/libs/qtip2/3.0.3/jquery.qtip.min.js" type="application/javascript"></script><script type="application/javascript" src="/common/js/navigation.js"></script><script type="application/javascript" src="/common/themes/pre-hdp-3.1/js/main.js"></script><script type="application/javascript" src="/common/themes/pre-hdp-3.1/js/htmlFileList.js"></script><script type="application/javascript" src="/common/themes/pre-hdp-3.1/js/htmlFileInfoList.js"></script><script type="application/javascript" src="/common/themes/pre-hdp-3.1/js/nwSearchFnt.js"></script><script type="application/javascript" src="/common/themes/pre-hdp-3.1/js/en_stemmer.js"></script><script type="application/javascript" src="/common/themes/pre-hdp-3.1/js/index-1.js"></script><script type="application/javascript" src="/common/themes/pre-hdp-3.1/js/index-2.js"></script><script type="application/javascript" src="/common/themes/pre-hdp-3.1/js/index-3.js"></script><script type="application/javascript">
      
      
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-22950817-19', 'auto');
    ga('send', 'pageview');
    
    
    </script><script type="application/javascript" src="/common/themes/pre-hdp-3.1/js/plugins.js"></script><script type="application/javascript" src="/common/themes/pre-hdp-3.1/js/scripts.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.3.0/highlight.min.js" type="application/javascript"></script><script type="application/javascript">
      
    // PAGE SPECIFIC SCRIPTS
    
    $('.chapters>li .dropdown').click(function () {
    var $arrow = $(this).find('i.fa');
    if( $arrow.hasClass('fa-chevron-down')) {
    $(this).siblings('.sections').show();
    $arrow.removeClass('fa-chevron-down').addClass('fa-chevron-up');
    } else {
    console.log('up');
    $(this).siblings('.sections').hide();
    $arrow.removeClass('fa-chevron-up').addClass('fa-chevron-down');
    }
    });
    
    //  $('h3').on('mouseenter',function() {
    //      console.log('received mouseover');
    //      $(this).find('.hash-link').show();
    //  });
    
    //  $('h3').on('mouseleave',function() {
    //      $(this).find('.hash-link').hide();
    //  });
    
    
    // STICKY SIDEBARs
    var stickySidebar = $('.sticky');
    
    if (stickySidebar.length > 0) {
    var stickyHeight = stickySidebar.height(),
    sidebarTop = stickySidebar.offset().top;
    }
    
    // on scroll move the sidebar
    $(window).scroll(function () {
    if (stickySidebar.length > 0) {
    var scrollTop = $(window).scrollTop();
    console.log
    
    if (sidebarTop < scrollTop) {
    stickySidebar.css('top', scrollTop - sidebarTop);
    
    // stop the sticky sidebar at the footer to avoid overlapping
    var sidebarBottom = stickySidebar.offset().top + stickyHeight,
    stickyStop = $('.main-content').offset().top + $('.main-content').height();
    if (stickyStop < sidebarBottom) {
    var stopPosition = $('.main-content').height() - stickyHeight;
    stickySidebar.css('top', stopPosition);
    }
    }
    else {
    stickySidebar.css('top', '0');
    }
    }
    });
    
    $(window).resize(function () {
    if (stickySidebar.length > 0) {
    stickyHeight = stickySidebar.height();
    }
    });
    
    // Initialize Syntax Highlighting
    hljs.initHighlightingOnLoad();
    
    </script><style type="text/css">
      
      
    input {
    margin-bottom: 5px;
    margin-top: 2px;
    }
    
    .folder {
    display: block;
    height: 22px;
    padding-left: 20px;
    background: transparent url(/common/themes/pre-hdp-3.1/images/folder.gif) 0 0px no-repeat;
    }
    
    </style><link href="/common/themes/pre-hdp-3.1/images/favicon.ico" rel="icon" type="image/x-icon" sizes="16x16"><link href="https://hortonworks.com/wp-content/uploads/2016/04/cropped-favicon521x512-70x70.png" rel="icon" type="image/x-icon" sizes="32x32"><link href="https://hortonworks.com/wp-content/uploads/2016/04/cropped-favicon521x512-300x300.png" rel="icon" type="image/x-icon" sizes="192x192"><link href="https://hortonworks.com/wp-content/uploads/2016/04/cropped-favicon521x512-300x300.png" rel="apple-touch-icon-precomposed" type="image/x-icon" sizes="192x192"><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.3.0/styles/default.min.css" rel="stylesheet"><link rel="stylesheet" media="screen, projection" href="/common/themes/pre-hdp-3.1/css/main.css"><link rel="stylesheet" media="screen, projection" href="/common/themes/pre-hdp-3.1/css/docux.css"><style type="text/css"></style><link rel="stylesheet" type="text/css" media="screen, projection" href="/common/themes/pre-hdp-3.1/css/jquery-ui-1.8.2.custom.css"><link rel="stylesheet" type="text/css" media="screen, projection" href="/common/themes/pre-hdp-3.1/css/jquery.treeview.css"><link href="https://cdn.jsdelivr.net/qtip2/3.0.3/jquery.qtip.min.css" rel="stylesheet" type="text/css" media="screen, projection"></head><body class="docs books"><div id="body_container"><div class="breadcrumb_bg"><!-- --></div><div id="navbar"><section class="ps topstrip"><div><!-- --></div></section></div><div id="mainbody"><section class="ps titlebar"><div><div class="breadcrumb"><a href="/">Hortonworks Docs</a> » <a id="index_page" href="../../index.html">Cloudera Runtime 1.0.0</a> » <span class="current_book">Apache Hive Performance Tuning</span></div><div class="book_title">Apache Hive Performance Tuning</div><div class="ebooks"><div class="formats"><span class="desc">Also available as:</span><div class="format"><a onclick="_gaq.push(['_trackEvent', 'Header', 'pdfDownload', 'click', 1]);" title="Download a PDF of this document" class="pdficon" href="../cr-hive_performance_tuning.pdf"><img src="/common/themes/pre-hdp-3.1/images/pdf.png" alt="PDF"></a></div></div></div></div></section><div class="lowerbody"><section class="ps doc-content"><div><div class="aside left"><div><div id="leftnavigation" style="padding-top:3px; background-color:white;"><div class="ui-tabs ui-widget ui-widget-content ui-corner-all"><div id="treeDiv" class="ui-tabs-panel ui-widget-content ui-corner-bottom"><img src="/common/themes/pre-hdp-3.1/images/loading.gif" alt="loading table of contents..." id="tocLoading" style="display:block;"><div id="ulTreeDiv" style="display:none" class="thisisthat"><ul id="tree" class="filetree"><li><a href="../topics/cr-hive_optimizing_data_warehouse.html">Optimizing an Apache Hive data warehouse</a></li><li><a href="../topics/cr-hive_prepare_to_tune_performance.html">Preparations for tuning performance</a></li><li><a href="../topics/cr-hive_setting_up_llap.html">Setting up LLAP</a><ul><li><a href="../topics/cr-hive_enable_yarn_preemption.html">Enable YARN preemption</a></li><li><a href="../topics/cr-hive_enable_interactive_query.html">Enable interactive query</a></li><li><a href="../topics/cr-hive_setup_multiple_hsi.html">Set up multiple HiveServer Interactives for high availability</a></li><li class="active"><a href="../topics/cr-hive_configure_llap_queue.html">Configure an llap queue</a></li><li><a href="../topics/cr-hive_llap_add_proxy.html">Add a Hive proxy</a></li><li><a href="../topics/cr-hive_setup_llap.html">Configure other LLAP properties</a></li><li><a href="../topics/cr-hive_hiveserver_heap_sizing.html">Configure the HiveServer heap size</a></li><li><a href="../topics/cr-hive_save_llap_restart.html">Save LLAP settings and restart services</a></li><li><a href="../topics/cr-hive_run_llap_query.html">Run an interactive query</a></li></ul></li><li><a href="../topics/cr-hive_llap_parameters.html">LLAP and HiveServer Interactive properties</a></li><li><a href="../topics/cr-hive_use_hiveserver_interactive.html">Use HiveServer Interactive UI</a></li><li><a href="../topics/cr-hive_connect_clients_to_llap.html">Connect a JDBC client to LLAP</a></li><li><a href="../topics/cr-hive_configuring_yarn_queues.html">Configuring YARN queues for Hive</a><ul><li><a href="../topics/cr-hive_configure_queue_for_batch.html">Configure a queue for batch processing</a></li><li><a href="../topics/cr-hive_configure_custom_llap_queue.html">Configure a custom LLAP queue</a></li></ul></li><li><a href="../topics/cr-hive_setup_multiple_hiveservers.html">Set up multiple HiveServer instances</a></li><li><a href="../topics/cr-hive_warehouse_processing.html">Key components of Hive warehouse processing</a></li><li><a href="../topics/cr-hive_query_result_cache_ms_cache.html">Query result cache and metastore cache</a></li><li><a href="../topics/cr-hive_tez_engine_properties.html">Tez execution engine properties</a></li><li><a href="../topics/cr-hive_monitoring_performance.html">Monitoring Apache Hive performance</a><ul><li><a href="../topics/cr-hive_monitor_llap_resources.html">Monitoring LLAP resources</a></li></ul></li><li><a href="../topics/cr-hive_maximize_storage_resources_using_orc.html">Maximizing storage resources using ORC</a><ul><li><a href="../topics/cr-hive_advanced_orc_properties.html">Advanced ORC properties</a></li></ul></li><li><a href="../topics/cr-hive_improving_performance_using_partitions.html">Improving performance using partitions</a></li><li><a href="../topics/cr-hive_bucketed_tables.html">Handling bucketed tables</a></li><li><a href="../topics/cr-hive_cost_based_optimizer_overview.html">Improving performance using the cost-based optimizer</a><ul><li><a href="../topics/cr-hive_set_up_cbo_and_stats.html">Set up the cost-based optimizer and statistics</a></li><li><a href="../topics/cr-hive_generate_hive_statistics.html">Generate and view Apache Hive statistics</a></li><li><a href="../topics/cr-hive_statistics_generation_and_viewing_commands.html">Statistics generation and viewing commands</a></li><li><a href="../topics/cr-hive_optimization_and_planning_properties.html">Optimization and planning properties</a></li></ul></li></ul></div></div></div></div></div><div class="formats"><div class="pdf"><!-- --></div></div></div><div class="next-prev-links"><span class="previouslink"><a class="link" href="../topics/cr-hive_setup_multiple_hsi.html" title="After enabling interactive query, you can optionally set up additional HiveServer Interactive instances for high-availablilty. One instance operates in active mode, the other in passive (standby) mode. The passive instance serves as a backup and takes over if the active instance goes down.">Prev</a></span><span class="nextlink"><a class="link" href="../topics/cr-hive_llap_add_proxy.html" title="To prevent network connection or notification problems, you must add a hive user proxy for HiveServer Interactive service to access the Hive Metastore.">Next</a></span></div><div id="content" aria-labelledby="ariaid-title1">
    <h1 class="title topictitle1" id="ariaid-title1">Configure an llap queue</h1>
    
    
    <div class="body taskbody"><p class="shortdesc">Ambari generally creates and configures an interactive query queue named
            <code class="ph codeph">llap</code> and points the Hive service to a YARN queue. You check, and if
        necessary, change the llap queue using YARN Queue Manager. </p>
        <section class="section context"><p class="p">The llap queue capacity determines the YARN resources for the LLAP application. Reconfiguring the
                llap queue is sometimes necessary. For example, if you have a 3-node cluster, Ambari
                might configure zero percent capacity for the llap queue, and you must reconfigure
                settings. If you set the llap queue capacity or number of nodes too low, you won’t
                have enough YARN resources or LLAP daemons to run the LLAP application. If you set
                the llap queue capacity too high, you waste space on the cluster.</p></section>
        <ol class="ol steps"><li class="li step stepexpand">
                <span class="ph cmd">In Ambari, select <span class="ph menucascade"><span class="ph uicontrol">Hive</span><abbr title="and then"> &gt; </abbr><span class="ph uicontrol">Configs</span></span>. </span>
            </li><li class="li step stepexpand">
                <span class="ph cmd">In Interactive Query Queue, choose the <code class="ph codeph">llap</code> queue if it
                    appears as a selection, and save the Hive configuration changes.:</span>
                <div class="itemgroup stepxmp">
                    <figure class="fig fignone">
                        <img class="image" id="hive_configure_llap_queue__image_rby_smt_r2b" src="../images/cr-hive_start_hive_interactive_query.png">
                    </figure>
                </div>
                <div class="itemgroup info">Depending on your YARN Capacity Scheduler settings, a queue named
                        <code class="ph codeph">llap</code> might or might not appear. This setting dedicates all
                    LLAP daemons and all YARN Application Masters (AMs) of the system to the single,
                    specified queue.</div>
            </li><li class="li step stepexpand">
                <span class="ph cmd">In Ambari, select Services &gt; YARN &gt; Configs. </span>
            </li><li class="li step stepexpand">
                <span class="ph cmd">From the hamburger menu Views, select YARN Queue Manager. </span>
                <div class="itemgroup stepxmp">
                    <figure class="fig fignone">
                        <img class="image" id="hive_configure_llap_queue__hive-llap-yarn-queue-manager" src="../images/cr-hive-llap-yarn-queue-manager.png">
                    </figure>
                </div>
            </li><li class="li step stepexpand">
                <span class="ph cmd">If an <code class="ph codeph">llap</code> queue does not exist, add a queue named
                        <code class="ph codeph">llap</code>. Otherwise, proceed to the next step.</span>
                
            </li><li class="li step stepexpand">
                <span class="ph cmd">If the llap queue is stopped, change the state to running.
                </span>
            </li><li class="li step stepexpand">
                <span class="ph cmd">Check the llap queue capacity, and accept or change the value
                    as follows: </span>
                <ul class="ul choices">
                    <li class="li choice">If the llap queue capacity is zero, you might have too few nodes for
                        Ambari to configure llap queue capacity. Go to the next step to configure
                        llap queue capacity and max capacity.<figure class="fig fignone">
                            <img class="image" id="hive_configure_llap_queue__image_snz_mpj_jfb" src="../images/cr-hive-llap-add-queue2.png">
                        </figure></li>
                    <li class="li choice">If Ambari set the llap capacity to greater than zero, no change is
                        necessary. Skip the next step. For example, in a 7-node cluster, Ambari
                        allocates llap queue capacity as follows:<figure class="fig fignone">
                            <img class="image" id="hive_configure_llap_queue__add-queue-nonzero" src="../images/cr-hive-llap-add-queue3.png">
                        </figure></li>
                </ul>
            </li><li class="li step stepexpand">
                <span class="ph cmd">If llap queue capacity is zero, increase the capacity allocated to your llap
                    queue, and also change max capacity to the remainder of the allocated llap
                    capacity minus 100 percent.</span>
                <div class="itemgroup stepxmp">
                    <p class="p">For example, set max capacity to 100 percent minus 50 percent = 50 percent.</p>
                    <figure class="fig fignone">
                        <img class="image" id="hive_configure_llap_queue__image_o1s_gpj_jfb" src="../images/cr-hive-llap-queue-capacity.png">
                    </figure>
                </div>
                <div class="itemgroup info">
                    <p class="p">Allocating 15-50 percent of cluster to the llap queue is common. </p>
                </div>
            </li><li class="li step stepexpand">
                <span class="ph cmd">Select the llap queue under Add Queue, and in Resources that
                    appears on the right, set <code class="ph codeph">User Limit Factor</code> to 1, and set
                        <code class="ph codeph">Priority</code> to greater than 0 (1 for example).</span>
            </li><li class="li step stepexpand">
                <span class="ph cmd">Select <span class="ph menucascade"><span class="ph uicontrol">Actions</span><abbr title="and then"> &gt; </abbr><span class="ph uicontrol">Save and Refresh Queues</span></span>.</span>
            </li><li class="li step stepexpand">
                <span class="ph cmd">In <span class="ph menucascade"><span class="ph uicontrol">Services</span><abbr title="and then"> &gt; </abbr><span class="ph uicontrol">YARN</span><abbr title="and then"> &gt; </abbr><span class="ph uicontrol">Summary</span></span> restart any YARN services as prompted.</span>
            </li></ol>
    </div>
<nav role="navigation" class="related-links"><div class="familylinks"><div class="parentlink"><strong>Parent topic:</strong> <a class="link" href="../topics/cr-hive_setting_up_llap.html" title="Using Ambari, you can set up basic, low-latency analytical processing (LLAP) by accepting the default llap queue, changing some YARN queue properties, and adding a HiveServer property to hive-site.xml.">Setting up LLAP</a></div></div></nav></div></div></section></div></div></div><section class="ps footer"><div><div class="copyright">© 2012–2019, Hortonworks, Inc.</div><div class="license">Document licensed under the <a href="https://creativecommons.org/licenses/by-sa/4.0/legalcode">Creative
          Commons Attribution ShareAlike 4.0 License</a>.</div><div class="menulinks"><a href="https://hortonworks.com">Hortonworks.com</a> | 
          <a href="#">Documentation</a> |
          <a href="https://hortonworks.com/support/">Support</a> |
          <a href="https://community.hortonworks.com/">Community</a></div></div></section></body></html>