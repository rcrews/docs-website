<html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="UTF-8"><meta name="DC.Type" content="task"><meta name="description" content="You can use the cost-based optimizer (CBO) and statistics to generate efficient query execution plans that can improve performance. You must generate column statistics to make CBO functional."><meta name="DC.subject" content="Hive, CBO, performance tuning, query plan"><meta name="keywords" content="Hive, CBO, performance tuning, query plan"><meta name="DC.Relation" scheme="URI" content="../topics/cr-hive_cost_based_optimizer_overview.html"><meta name="prodname" content="Cloudera Runtime"><meta name="version" content="1"><meta name="release" content="0"><meta name="modification" content="0"><meta name="brand" content="Cloudera Runtime"><meta name="rights" content="© 2019 Cloudera, Inc."><meta name="DC.Date.Created" content="2019-04-15"><meta name="DC.Date.Modified" content="2019-04-15"><meta name="DC.Format" content="XHTML"><meta name="DC.Identifier" content="hive_using_cbo"><link rel="stylesheet" type="text/css" href="../commonltr.css"><title>Set up the cost-based optimizer and statistics</title><script type="application/javascript">
      
      
    //The id for tree cookie
    var treeCookieId = "treeview-bk_release-notes";
    var language = "en";
    var w = new Object();
    //Localization
    txt_filesfound = 'Results';
    txt_enter_at_least_1_char = "You must enter at least one character.";
    txt_browser_not_supported = "Please enable JavaScript.";
    txt_please_wait = "Please wait. Search in progress...";
    txt_results_for = "Results for: ";
    
    
    </script><script type="application/javascript" src="https://code.jquery.com/jquery-1.4.3.min.js"></script><script type="application/javascript" src="/common/themes/pre-hdp-3.1/js/jquery-ui-1.8.2.custom.min.js"></script><script type="application/javascript" src="/common/themes/pre-hdp-3.1/js/jquery.cookie.js"></script><script type="application/javascript" src="/common/themes/pre-hdp-3.1/js/jquery.treeview.min.js"></script><link href="https://cdn.jsdelivr.net/qtip2/3.0.3/jquery.qtip.min.css" rel="stylesheet" type="text/css" media="screen, projection"><script src="https://cdnjs.cloudflare.com/ajax/libs/qtip2/3.0.3/jquery.qtip.min.js" type="application/javascript"></script><script type="application/javascript" src="/common/js/navigation.js"></script><script type="application/javascript" src="/common/themes/pre-hdp-3.1/js/main.js"></script><script type="application/javascript" src="/common/themes/pre-hdp-3.1/js/htmlFileList.js"></script><script type="application/javascript" src="/common/themes/pre-hdp-3.1/js/htmlFileInfoList.js"></script><script type="application/javascript" src="/common/themes/pre-hdp-3.1/js/nwSearchFnt.js"></script><script type="application/javascript" src="/common/themes/pre-hdp-3.1/js/en_stemmer.js"></script><script type="application/javascript" src="/common/themes/pre-hdp-3.1/js/index-1.js"></script><script type="application/javascript" src="/common/themes/pre-hdp-3.1/js/index-2.js"></script><script type="application/javascript" src="/common/themes/pre-hdp-3.1/js/index-3.js"></script><script type="application/javascript">
      
      
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-22950817-19', 'auto');
    ga('send', 'pageview');
    
    
    </script><script type="application/javascript" src="/common/themes/pre-hdp-3.1/js/plugins.js"></script><script type="application/javascript" src="/common/themes/pre-hdp-3.1/js/scripts.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.3.0/highlight.min.js" type="application/javascript"></script><script type="application/javascript">
      
    // PAGE SPECIFIC SCRIPTS
    
    $('.chapters>li .dropdown').click(function () {
    var $arrow = $(this).find('i.fa');
    if( $arrow.hasClass('fa-chevron-down')) {
    $(this).siblings('.sections').show();
    $arrow.removeClass('fa-chevron-down').addClass('fa-chevron-up');
    } else {
    console.log('up');
    $(this).siblings('.sections').hide();
    $arrow.removeClass('fa-chevron-up').addClass('fa-chevron-down');
    }
    });
    
    //  $('h3').on('mouseenter',function() {
    //      console.log('received mouseover');
    //      $(this).find('.hash-link').show();
    //  });
    
    //  $('h3').on('mouseleave',function() {
    //      $(this).find('.hash-link').hide();
    //  });
    
    
    // STICKY SIDEBARs
    var stickySidebar = $('.sticky');
    
    if (stickySidebar.length > 0) {
    var stickyHeight = stickySidebar.height(),
    sidebarTop = stickySidebar.offset().top;
    }
    
    // on scroll move the sidebar
    $(window).scroll(function () {
    if (stickySidebar.length > 0) {
    var scrollTop = $(window).scrollTop();
    console.log
    
    if (sidebarTop < scrollTop) {
    stickySidebar.css('top', scrollTop - sidebarTop);
    
    // stop the sticky sidebar at the footer to avoid overlapping
    var sidebarBottom = stickySidebar.offset().top + stickyHeight,
    stickyStop = $('.main-content').offset().top + $('.main-content').height();
    if (stickyStop < sidebarBottom) {
    var stopPosition = $('.main-content').height() - stickyHeight;
    stickySidebar.css('top', stopPosition);
    }
    }
    else {
    stickySidebar.css('top', '0');
    }
    }
    });
    
    $(window).resize(function () {
    if (stickySidebar.length > 0) {
    stickyHeight = stickySidebar.height();
    }
    });
    
    // Initialize Syntax Highlighting
    hljs.initHighlightingOnLoad();
    
    </script><style type="text/css">
      
      
    input {
    margin-bottom: 5px;
    margin-top: 2px;
    }
    
    .folder {
    display: block;
    height: 22px;
    padding-left: 20px;
    background: transparent url(/common/themes/pre-hdp-3.1/images/folder.gif) 0 0px no-repeat;
    }
    
    </style><link href="/common/themes/pre-hdp-3.1/images/favicon.ico" rel="icon" type="image/x-icon" sizes="16x16"><link href="https://hortonworks.com/wp-content/uploads/2016/04/cropped-favicon521x512-70x70.png" rel="icon" type="image/x-icon" sizes="32x32"><link href="https://hortonworks.com/wp-content/uploads/2016/04/cropped-favicon521x512-300x300.png" rel="icon" type="image/x-icon" sizes="192x192"><link href="https://hortonworks.com/wp-content/uploads/2016/04/cropped-favicon521x512-300x300.png" rel="apple-touch-icon-precomposed" type="image/x-icon" sizes="192x192"><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.3.0/styles/default.min.css" rel="stylesheet"><link rel="stylesheet" media="screen, projection" href="/common/themes/pre-hdp-3.1/css/main.css"><link rel="stylesheet" media="screen, projection" href="/common/themes/pre-hdp-3.1/css/docux.css"><style type="text/css"></style><link rel="stylesheet" type="text/css" media="screen, projection" href="/common/themes/pre-hdp-3.1/css/jquery-ui-1.8.2.custom.css"><link rel="stylesheet" type="text/css" media="screen, projection" href="/common/themes/pre-hdp-3.1/css/jquery.treeview.css"><link href="https://cdn.jsdelivr.net/qtip2/3.0.3/jquery.qtip.min.css" rel="stylesheet" type="text/css" media="screen, projection"></head><body class="docs books"><div id="body_container"><div class="breadcrumb_bg"><!-- --></div><div id="navbar"><section class="ps topstrip"><div><!-- --></div></section></div><div id="mainbody"><section class="ps titlebar"><div><div class="breadcrumb"><a href="/">Hortonworks Docs</a> » <a id="index_page" href="../../index.html">Cloudera Runtime 1.0.0</a> » <span class="current_book">Apache Hive Performance Tuning</span></div><div class="book_title">Apache Hive Performance Tuning</div><div class="ebooks"><div class="formats"><span class="desc">Also available as:</span><div class="format"><a onclick="_gaq.push(['_trackEvent', 'Header', 'pdfDownload', 'click', 1]);" title="Download a PDF of this document" class="pdficon" href="../cr-hive_performance_tuning.pdf"><img src="/common/themes/pre-hdp-3.1/images/pdf.png" alt="PDF"></a></div></div></div></div></section><div class="lowerbody"><section class="ps doc-content"><div><div class="aside left"><div><div id="leftnavigation" style="padding-top:3px; background-color:white;"><div class="ui-tabs ui-widget ui-widget-content ui-corner-all"><div id="treeDiv" class="ui-tabs-panel ui-widget-content ui-corner-bottom"><img src="/common/themes/pre-hdp-3.1/images/loading.gif" alt="loading table of contents..." id="tocLoading" style="display:block;"><div id="ulTreeDiv" style="display:none" class="thisisthat"><ul id="tree" class="filetree"><li><a href="../topics/cr-hive_optimizing_data_warehouse.html">Optimizing an Apache Hive data warehouse</a></li><li><a href="../topics/cr-hive_prepare_to_tune_performance.html">Preparations for tuning performance</a></li><li><a href="../topics/cr-hive_setting_up_llap.html">Setting up LLAP</a><ul><li><a href="../topics/cr-hive_enable_yarn_preemption.html">Enable YARN preemption</a></li><li><a href="../topics/cr-hive_enable_interactive_query.html">Enable interactive query</a></li><li><a href="../topics/cr-hive_setup_multiple_hsi.html">Set up multiple HiveServer Interactives for high availability</a></li><li><a href="../topics/cr-hive_configure_llap_queue.html">Configure an llap queue</a></li><li><a href="../topics/cr-hive_llap_add_proxy.html">Add a Hive proxy</a></li><li><a href="../topics/cr-hive_setup_llap.html">Configure other LLAP properties</a></li><li><a href="../topics/cr-hive_hiveserver_heap_sizing.html">Configure the HiveServer heap size</a></li><li><a href="../topics/cr-hive_save_llap_restart.html">Save LLAP settings and restart services</a></li><li><a href="../topics/cr-hive_run_llap_query.html">Run an interactive query</a></li></ul></li><li><a href="../topics/cr-hive_llap_parameters.html">LLAP and HiveServer Interactive properties</a></li><li><a href="../topics/cr-hive_use_hiveserver_interactive.html">Use HiveServer Interactive UI</a></li><li><a href="../topics/cr-hive_connect_clients_to_llap.html">Connect a JDBC client to LLAP</a></li><li><a href="../topics/cr-hive_configuring_yarn_queues.html">Configuring YARN queues for Hive</a><ul><li><a href="../topics/cr-hive_configure_queue_for_batch.html">Configure a queue for batch processing</a></li><li><a href="../topics/cr-hive_configure_custom_llap_queue.html">Configure a custom LLAP queue</a></li></ul></li><li><a href="../topics/cr-hive_setup_multiple_hiveservers.html">Set up multiple HiveServer instances</a></li><li><a href="../topics/cr-hive_warehouse_processing.html">Key components of Hive warehouse processing</a></li><li><a href="../topics/cr-hive_query_result_cache_ms_cache.html">Query result cache and metastore cache</a></li><li><a href="../topics/cr-hive_tez_engine_properties.html">Tez execution engine properties</a></li><li><a href="../topics/cr-hive_monitoring_performance.html">Monitoring Apache Hive performance</a><ul><li><a href="../topics/cr-hive_monitor_llap_resources.html">Monitoring LLAP resources</a></li></ul></li><li><a href="../topics/cr-hive_maximize_storage_resources_using_orc.html">Maximizing storage resources using ORC</a><ul><li><a href="../topics/cr-hive_advanced_orc_properties.html">Advanced ORC properties</a></li></ul></li><li><a href="../topics/cr-hive_improving_performance_using_partitions.html">Improving performance using partitions</a></li><li><a href="../topics/cr-hive_bucketed_tables.html">Handling bucketed tables</a></li><li><a href="../topics/cr-hive_cost_based_optimizer_overview.html">Improving performance using the cost-based optimizer</a><ul><li class="active"><a href="../topics/cr-hive_set_up_cbo_and_stats.html">Set up the cost-based optimizer and statistics</a></li><li><a href="../topics/cr-hive_generate_hive_statistics.html">Generate and view Apache Hive statistics</a></li><li><a href="../topics/cr-hive_statistics_generation_and_viewing_commands.html">Statistics generation and viewing commands</a></li><li><a href="../topics/cr-hive_optimization_and_planning_properties.html">Optimization and planning properties</a></li></ul></li></ul></div></div></div></div></div><div class="formats"><div class="pdf"><!-- --></div></div></div><div class="next-prev-links"></div><div id="content" aria-labelledby="ariaid-title1">
    <h1 class="title topictitle1" id="ariaid-title1">Set up the cost-based optimizer and statistics</h1>
    
    
    <div class="body taskbody"><p class="shortdesc">You can use the cost-based optimizer (CBO) and statistics to generate efficient query
        execution plans that can improve performance. You must generate column statistics to make
        CBO functional.</p>
        <section class="section context">
            <p class="p">In this task, you enable and configure the cost-based optimizer (CBO) and configure
                Hive to gather column and table statistics for evaluating query performance. Column
                and table statistics are critical for estimating predicate selectivity and cost of
                the plan. Certain advanced rewrites require column statistics.</p>
            <p class="p"> In this task, you check, and set the following properties in the
                    <span class="ph filepath">hive-site.xml</span> configuration file:</p>
            <ul class="ul">
                <li class="li"><code class="ph codeph">hive.stats.autogather</code>
                    <p class="p">Controls collection of table-level statistics.</p></li>
                <li class="li"><code class="ph codeph">hive.stats.fetch.column.stats</code><p class="p">Controls collection of
                        column-level statistics.</p></li>
                <li class="li"><code class="ph codeph">hive.compute.query.using.stats</code><p class="p">Instructs Hive to use
                        statistics when generating query plans.</p></li>
            </ul>
            <p class="p">All of these properties are checked by default. You can manually generate the
                table-level statistics for newly created tables and table partitions using the
                ANALYZE TABLE statement.</p>
        </section>
        <div class="section prereq p">
            <ul class="ul">
            <li class="li">You installed Ambari.</li>
                <li class="li">You added the Apache Hive service and started all components.</li>
                <li class="li">You have administrative privileges to configure Hive in Ambari.</li>
            </ul>
        </div>
       <ol class="ol steps"><li class="li step stepexpand">
                       <span class="ph cmd">In Ambari, select 
                           <span class="ph menucascade"><span class="ph uicontrol">Services</span><abbr title="and then"> &gt; </abbr><span class="ph uicontrol">Hive</span><abbr title="and then"> &gt; </abbr><span class="ph uicontrol">Configs</span></span>.</span>
                   </li><li class="li step stepexpand">
                <span class="ph cmd">Enable cost-based optimization if you changed the default: In Filter, enter
                        <code class="ph codeph">hive.cbo.enable</code>, and check the checkbox.</span>
                       <div class="itemgroup stepxmp"><img class="image" id="hive_using_cbo__image_vyz_nm3_s2b" src="../images/cr-hive_filter_properties.png"></div>
            </li><li class="li step stepexpand">
                <span class="ph cmd">Configure automatic gathering of table-level statistics for newly created
                    tables and table partitions if you changed the default: In Filter, enter
                        <code class="ph codeph">hive.stats.autogather</code>, and check the checkbox.</span>
            </li><li class="li step stepexpand">
                       <span class="ph cmd">Configure Hive to use statistics when generating query plans: In Filter, enter <code class="ph codeph">hive.compute.query.using.stats</code>, and check the checkbox.</span>
                   </li></ol>
    </div>
<nav role="navigation" class="related-links"><div class="familylinks"><div class="parentlink"><strong>Parent topic:</strong> <a class="link" href="../topics/cr-hive_cost_based_optimizer_overview.html" title="A cost-based optimizer (CBO) generates efficient query plans, but to effectively use the CBO to optimize Hive data, you must generate column statistics for tables.">Improving performance using the cost-based optimizer</a></div></div></nav></div></div></section></div></div></div><section class="ps footer"><div><div class="copyright">© 2012–2019, Hortonworks, Inc.</div><div class="license">Document licensed under the <a href="https://creativecommons.org/licenses/by-sa/4.0/legalcode">Creative
          Commons Attribution ShareAlike 4.0 License</a>.</div><div class="menulinks"><a href="https://hortonworks.com">Hortonworks.com</a> | 
          <a href="#">Documentation</a> |
          <a href="https://hortonworks.com/support/">Support</a> |
          <a href="https://community.hortonworks.com/">Community</a></div></div></section></body></html>