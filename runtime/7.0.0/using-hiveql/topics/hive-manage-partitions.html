<!DOCTYPE html><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="UTF-8"><meta name="DC.Type" content="task"><meta name="description" content="You can discover partition changes and synchronize Hive metadata automatically. Performing synchronization automatically as opposed to manually can save substantial time, especially when partitioned data, such as logs, changes frequently. You can also configure how long to retain partition data and metadata."><meta name="DC.Relation" scheme="URI" content="../topics/hive-automate-msck.html"><meta name="DC.Relation" scheme="URI" content="../topics/hive-set-partition-retention.html"><meta name="DC.Relation" scheme="URI" content="../topics/hive-create_partitions_dynamically.html"><meta name="DC.Relation" scheme="URI" content="https://cwiki.apache.org/confluence/display/Hive/LanguageManual+DDL#LanguageManualDDL-DiscoverPartitions"><meta name="prodname" content="Data Access"><meta name="version" content="3"><meta name="release" content="1"><meta name="modification" content="0"><meta name="brand" content="Data Platform"><meta name="rights" content="© 2019, 2018, 2017, 2016 Cloudera, Inc."><meta name="DC.Date.Created" content="2018-07-12"><meta name="DC.Date.Modified" content="2018-07-12"><meta name="DC.Format" content="XHTML"><meta name="DC.Identifier" content="hive-manage-partitions"><meta name="viewport" content="width=device-width, initial-scale=1"><meta name="description" content=""><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/font-awesome/5.8.2/css/all.css"><link rel="stylesheet" href="/common/css/main.css"><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.3.0/styles/default.min.css"><title>Manage partitions automatically</title></head><body class="hg"><header class="chead"><div class="breadcrumbs">
<span class="bread-home"><a href="/"><i class="fas fa-home"></i><span class="text-home">Cloudera Docs</span></a></span>
<span class="bread-product"></span>
<span class="bread-version"></span>
<span class="bread-category">Category</span></div>
<div class="search"><i class="search-close fas fa-times"></i><input type="text" placeholder="Search Documentation"><i class="fas fa-search"></i></div><div class="launch-search"><i class="fas fa-search"></i></div><div class="launch-pubnav"><i class="fas fa-bars"></i></div></header><main class="cmain"><div class="cpage"><article class="maincontent"><div class="inner-breadcrumbs">Concepts</div><div id="content" aria-labelledby="ariaid-title1">
    <h1 class="title topictitle1" id="ariaid-title1">Manage partitions automatically</h1>
    
    <div class="body taskbody"><p class="shortdesc">You can discover partition changes and synchronize Hive
        metadata automatically. Performing synchronization automatically as opposed to manually can
        save substantial time, especially when partitioned data, such as logs, changes frequently.
        You can also configure how long to retain partition data and metadata.</p>
        <section class="section context">
            <p class="p">After creating a partitioned table, Hive does not update metadata about corresponding
                objects or directories on the file system that you add or drop. The partition
                metadata in the Hive metastore becomes stale after corresponding objects/directories
                are added or deleted. You need to synchronize the metastore and the file system.
                </p><div class="p">You can refresh Hive metastore partition information manually or
                    automatically.<ul class="ul" id="hive-manage-partitions__ul_gst_43t_13b">
                    <li class="li">Manually <p class="p">You run the MSCK (metastore consistency check) Hive command:
                                <code class="ph codeph">MSCK REPAIR TABLE table_name SYNC PARTITIONS</code> every
                            time you need to synchronize a partition with the file system.</p></li>
                    <li class="li">Automatically<p class="p">You set up partition discovery to occur
                        periodically.</p></li>
                </ul></div><div class="p">The discover.partitions table property is automatically created and
                enabled for external partitioned tables. When <code class="ph codeph">discover.partitions</code>
                is enabled for a table, Hive performs an automatic refresh as follows: <ul class="ul" id="hive-manage-partitions__ul_bwz_ggt_13b">
                    <li class="li">Adds corresponding partitions that are in the file system, but not in
                        metastore, to the metastore.</li>
                    <li class="li">Removes partition schema information from metastore if you removed the
                        corresponding partitions from the file system. </li>
                </ul></div><p class="p"><strong class="ph b">Partition retention</strong></p>You can configure how long to keep
            partition metadata and data, and remove it after the retention period elapses.
                    <p class="p"><strong class="ph b">Limitations</strong></p> Generally, partition discovery and retention is not
            recommended for use on managed tables. The Hive metastore acquires an exclusive lock on
            a table that enables partition discovery that can slow down other queries. </section>
        
    </div>
<nav role="navigation" class="related-links"><ul class="ullinks"><li class="link ulchildlink"><strong><a href="../topics/hive-automate-msck.html">Automate partition discovery and repair</a></strong><br>Hive automatically and periodically discovers discrepancies in partition metadata in         the Hive metastore and corresponding directories or objects on the file system, and then         performs synchronization. This operation is often automated for processing log data or data         in Spark and Hive catalogs. </li><li class="link ulchildlink"><strong><a href="../topics/hive-set-partition-retention.html">Manage partition retention time</a></strong><br>You can keep the size of the Hive metadata and data you accumulate for log processing, and other activities,          to a manageable size by setting a retention period for the data.  </li></ul><div class="linklist relinfo"><strong>Related information</strong><br><div><a class="link" href="../topics/hive-create_partitions_dynamically.html" title="You can configure Hive to create partitions dynamically and then run a query that creates the related directories on the file system, such as S3. Hive then separates the data into the directories.">Create partitions dynamically</a></div><div><a class="link" href="https://cwiki.apache.org/confluence/display/Hive/LanguageManual+DDL#LanguageManualDDL-DiscoverPartitions" target="_blank">Apache Wiki: Discover Partitions and Partition Retention</a></div></div></nav></div></article><div class="short-prev"><a href="">«</a></div><div class="short-next"><a href="">»</a></div><div class="up"></div><div class="prev"><a href="">« Getting Started with Apache Nifi</a></div><div class="next">Getting Started: <a href="">Terminology Used in This Guide »</a></div></div><aside class="pubmenu"><div class="product-title"><img class="product-logo" src="/common/img/smaller_icons/icon-hdf.png"><span class="product-name">Cloudera Data Platform</span></div><nav class="ctoc"></nav></aside></main><div class="logo"><a href="/"><img src="//www.cloudera.com/apps/settings/wcm/designs/www/clientlibs/css/assets/icons/favicon/apple-touch-icon-152x152.png"></a></div><nav class="product-drawer"><div class="full-logo"><img src="/common/img/cloudera.png"></div><ul class="products"><li class="cat">Data Platforms</li><li><img src="/common/img/mini_icons/icon-ambari.png"><span class="text">Ambari</span></li><li><img src="/common/img/mini_icons/icon-hdp.png"><span class="text">Data Platform</span></li><li class="active"><img src="/common/img/mini_icons/icon-hdf.png"><span class="text">Dataflow</span></li><li><img src="/common/img/mini_icons/icon-smartsense.png"><span class="text">Smartsense</span></li><li><img src="/common/img/mini_icons/icon-cybersecurity.png"><span class="text">Cybersecurity</span></li><li class="cat">Data Services</li><li><img src="/common/img/mini_icons/icon-dataplane.png"><span class="text">DataPlane Core</span></li><li><img src="/common/img/mini_icons/icon-studio.png"><span class="text">Data Analytics Studio</span></li><li><img src="/common/img/mini_icons/icon-datasteward.png"><span class="text">Data Steward Studio</span></li><li class="cat">Cloud Services</li><li><img src="/common/img/mini_icons/icon-cloudbreak.png"><span class="text">Cloudbreak</span></li><li><img src="/common/img/mini_icons/icon-hdcloud.png"><span class="text">HDCloud for AWS</span></li></ul><div class="open-close">»</div></nav><footer></footer><script src="//cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script><script src="/common/js/main.js"></script><script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.3.0/highlight.min.js" class="test"></script></body></html>