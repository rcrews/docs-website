<!DOCTYPE html><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="UTF-8"><meta name="DC.Type" content="task"><meta name="description" content="The MSCK REPAIR TABLE command was designed to manually add partitions that are added to or removed from the file system, such S3, but are not present in the Hive metastore."><meta name="DC.Relation" scheme="URI" content="../topics/hive-create_partitions_dynamically.html"><meta name="prodname" content="Data Access"><meta name="version" content="3"><meta name="release" content="1"><meta name="modification" content="0"><meta name="brand" content="Data Platform"><meta name="rights" content="© 2019, 2018, 2017, 2016 Cloudera, Inc."><meta name="DC.Date.Created" content="2018-07-12"><meta name="DC.Date.Modified" content="2018-07-12"><meta name="DC.Format" content="XHTML"><meta name="DC.Identifier" content="hive-msck-repair"><meta name="viewport" content="width=device-width, initial-scale=1"><meta name="description" content=""><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/font-awesome/5.8.2/css/all.css"><link rel="stylesheet" href="/common/css/main.css"><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.3.0/styles/default.min.css"><title>Repair partitions using MSCK repair</title></head><body class="hg"><header class="chead"><div class="breadcrumbs">
<span class="bread-home"><a href="/"><i class="fas fa-home"></i><span class="text-home">Cloudera Docs</span></a></span>
<span class="bread-product"></span>
<span class="bread-version"></span>
<span class="bread-category">Category</span></div>
<div class="search"><i class="search-close fas fa-times"></i><input type="text" placeholder="Search Documentation"><i class="fas fa-search"></i></div><div class="launch-search"><i class="fas fa-search"></i></div><div class="launch-pubnav"><i class="fas fa-bars"></i></div></header><main class="cmain"><div class="cpage"><article class="maincontent"><div class="inner-breadcrumbs">Concepts</div><div id="content" aria-labelledby="ariaid-title1">
    <h1 class="title topictitle1" id="ariaid-title1">Repair partitions using MSCK repair</h1>
    
    <div class="body taskbody"><p class="shortdesc">The MSCK REPAIR TABLE command was designed to manually add partitions that are added
        to or removed from the file system, such S3, but are not present in the Hive
        metastore.</p>
        <section class="section context">
            <p class="p">This task assumes you created a partitioned external table named
                    <code class="ph codeph">emp_part</code> that stores partitions outside the warehouse. You
                remove one of the partition directories on the file system. This action renders the
                metastore inconsistent with the file system. You repair the discrepancy manually to
                synchronize the metastore with the file system, HDFS for example. </p>
        </section>
        <ol class="ol steps"><li class="li step stepexpand">
                <span class="ph cmd">Remove the <code class="ph codeph">dept=sales</code> object from S3.</span>
                
            </li><li class="li step stepexpand">
                <span class="ph cmd">In Data Analytics Studio (DAS) or in the Hive shell, look at the
                        <code class="ph codeph">emp_part</code> table partitions.</span>
                <div class="itemgroup stepxmp">
                    <pre class="pre codeblock"><code>SHOW PARTITIONS emp_part;</code></pre>
                </div>
                <div class="itemgroup stepresult">The list of partitions is stale; it still includes the dept=sales
                    directory.<pre class="pre codeblock"><code>+----------------+
|   partition    |
+----------------+
| dept=finance   |
| dept=sales     |
| dept=service   |
+----------------+</code></pre></div>
            </li><li class="li step stepexpand">
                <span class="ph cmd">Repair the partition manually.</span>
                <div class="itemgroup stepxmp">
                    <pre class="pre codeblock"><code>MSCK REPAIR TABLE emp_part DROP PARTITIONS;</code></pre>
                </div>
            </li></ol>
    </div>
<nav role="navigation" class="related-links"><div class="familylinks"><div class="parentlink"><strong>Parent topic:</strong> <a class="link" href="../topics/hive-create_partitions_dynamically.html" title="You can configure Hive to create partitions dynamically and then run a query that creates the related directories on the file system, such as S3. Hive then separates the data into the directories.">Create partitions dynamically</a></div></div></nav></div></article><div class="short-prev"><a href="">«</a></div><div class="short-next"><a href="">»</a></div><div class="up"></div><div class="prev"><a href="">« Getting Started with Apache Nifi</a></div><div class="next">Getting Started: <a href="">Terminology Used in This Guide »</a></div></div><aside class="pubmenu"><div class="product-title"><img class="product-logo" src="/common/img/smaller_icons/icon-hdf.png"><span class="product-name">Cloudera Data Platform</span></div><nav class="ctoc"></nav></aside></main><div class="logo"><a href="/"><img src="//www.cloudera.com/apps/settings/wcm/designs/www/clientlibs/css/assets/icons/favicon/apple-touch-icon-152x152.png"></a></div><nav class="product-drawer"><div class="full-logo"><img src="/common/img/cloudera.png"></div><ul class="products"><li class="cat">Data Platforms</li><li><img src="/common/img/mini_icons/icon-ambari.png"><span class="text">Ambari</span></li><li><img src="/common/img/mini_icons/icon-hdp.png"><span class="text">Data Platform</span></li><li class="active"><img src="/common/img/mini_icons/icon-hdf.png"><span class="text">Dataflow</span></li><li><img src="/common/img/mini_icons/icon-smartsense.png"><span class="text">Smartsense</span></li><li><img src="/common/img/mini_icons/icon-cybersecurity.png"><span class="text">Cybersecurity</span></li><li class="cat">Data Services</li><li><img src="/common/img/mini_icons/icon-dataplane.png"><span class="text">DataPlane Core</span></li><li><img src="/common/img/mini_icons/icon-studio.png"><span class="text">Data Analytics Studio</span></li><li><img src="/common/img/mini_icons/icon-datasteward.png"><span class="text">Data Steward Studio</span></li><li class="cat">Cloud Services</li><li><img src="/common/img/mini_icons/icon-cloudbreak.png"><span class="text">Cloudbreak</span></li><li><img src="/common/img/mini_icons/icon-hdcloud.png"><span class="text">HDCloud for AWS</span></li></ul><div class="open-close">»</div></nav><footer></footer><script src="//cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script><script src="/common/js/main.js"></script><script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.3.0/highlight.min.js" class="test"></script></body></html>