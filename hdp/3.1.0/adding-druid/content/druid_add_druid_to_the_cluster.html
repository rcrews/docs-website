<html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous"><link href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,500,500i,700,700i%7cRoboto+Condensed:300,300i,400,400i,700,700i%7cRoboto+Mono:400,400i,700,700i%7cRoboto+Slab:400,400i,700,700i" rel="stylesheet"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.5.0/css/all.css" integrity="sha384-B4dIYHKNBt8Bc12p+WXckhzcICo0wtJAoU8YZTY5qE0Id1GSseTk6S+L3BlXeVIU" crossorigin="anonymous"><title>Add Apache Druid to the cluster</title><meta name="description" content="You use Apache Ambari to add Apache Druid (incubating) to your cluster."><link rel="stylesheet" href="/common/css/main.css"><script src="/common/js/main.js"></script></head><body class="hg"><article class="hg-body"><main><div id="content" aria-labelledby="ariaid-title1">
    <h1 class="title topictitle1" id="ariaid-title1">Add Apache Druid to the cluster</h1>
    
    <div class="body taskbody"><p class="shortdesc">You use Apache Ambari to add Apache Druid (incubating) to your cluster.</p>
        <section class="section context"> To use Druid in a real-world environment, the cluster must have access to the
            following resources to make Druid operational in HDP: <ul class="ul">
                <li class="li">ZooKeeper: <p class="p">A Druid instance requires that you select Apache ZooKeeper as a
                        Service when you add Druid to the cluster; otherwise, Ambari does not add
                        Druid to the cluster. ZooKeeper coordinates Druid nodes and manages
                        elections among coordinator and overlord nodes. </p></li>
                <li class="li">Deep storage: <p class="p">HDFS or Amazon S3 can be used as the deep storage layer for
                        Druid in HDP. In Ambari, you can select HDFS as a Service for this storage
                        layer. Alternatively, you can set up Druid to use Amazon S3 as the deep
                        storage layer by setting the <code class="ph codeph">druid.storage.type</code> property to
                            <code class="ph codeph">s3</code>. The cluster relies on the distributed file system
                        to store Druid segments for permanent backup of the data.</p></li>
                <li class="li">Metadata storage: <p class="p">The metadata store is used to persist information about
                        Druid segments and tasks. MySQL and Postgres are supported metadata stores.
                        You can select the metadata database when you install and configure Druid
                        with Ambari.</p></li>
                <li class="li">Batch execution engine: <p class="p">Select YARN + MapReduce2 for the execution resource
                        manager and execution engine, respectively. Druid Hadoop index tasks use
                        MapReduce jobs for distributed ingestion of large amounts of data. </p></li>
                <li class="li">(Optional) Druid metrics reporting: <p class="p">If you plan to monitor Druid performance
                        metrics using Grafana dashboards in Ambari, select Ambari Metrics System as
                        a Service.</p></li>
            </ul><p class="p">If you plan to deploy high availability (HA) on a Druid cluster, you need to
                know which components to install and how to configure the installation so that the
                Druid instance is primed for an HA environment.</p><p class="p">As you add Druid as a service,
                you generally replicate the following components:</p><ul class="ul">
                <li class="li">Druid Historical: Loads data segments.</li>
                <li class="li">Druid MiddleManager: Runs Druid indexing tasks.</li>
            </ul></section>
        <div class="section prereq p">
            <p class="p">You have installed the following components:</p>
            <ul class="ul">
                <li class="li">Ambari 2.7.0 or later</li>
                <li class="li">HDP 3.0 or later using Ambari</li>
                <li class="li">ZooKeeper</li>
                <li class="li">HDFS or Amazon S3</li>
                <li class="li">A MySQL or Postgres database for storing metadata if you need high availability;
                    otherwise, you can use the default Derby database installed and configured by
                    Ambari.</li>
                <li class="li">YARN and MapReduce2</li>
            </ul>
        </div>
        <ol class="ol steps"><li class="li step stepexpand">
                <span class="ph cmd">From the Ambari navigation pane, select Services &gt; Add Service.</span>
            </li><li class="li step stepexpand">
                <span class="ph cmd">Select Druid, and click Next.</span>
            </li><li class="li step stepexpand">
                <span class="ph cmd">In Assign Masters, select Druid Historical and Druid MiddleManager for multiple
                    nodes.</span>
                <div class="itemgroup stepxmp"><img class="image" id="install_druid__image_ukl_vzb_2gb" src="../how-to/images/druid_assign_multiple.png"></div>
            </li><li class="li step stepexpand">
                <span class="ph cmd">In Customize Services, select a Druid Metadata storage type or accept the
                    default Derby database.</span>
            </li><li class="li step stepexpand">
                <span class="ph cmd">Enter a Metadata storage password.</span>
            </li><li class="li step stepexpand">
                <span class="ph cmd">Accept the default configuration values and suggested changes if you use the
                    default Derby database.</span>
            </li><li class="li step stepexpand">
                <span class="ph cmd">Click Next, and Deploy.</span>
            </li><li class="li step stepexpand">
                <span class="ph cmd">Check Apache Ambari Installation Guide if you encounter any problems to see if other components are needed for your particular cluster.</span>
            </li></ol>
    </div>
</div></main><nav class="products"></nav><nav class="topics"></nav><aside class="right-info"></aside></article><header></header><footer></footer><div class="modal fade" id="bModal" tabindex="-1" role="dialog" aria-labelledby="bModalLabel" aria-hidden="true"><div class="modal-dialog" role="document"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="bModalLabel"></h5><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">✖️</span></button></div><div class="modal-body" id="bModalList"></div></div></div></div><script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script><script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script></body></html>