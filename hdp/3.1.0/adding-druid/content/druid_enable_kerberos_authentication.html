<html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous"><link href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,500,500i,700,700i%7cRoboto+Condensed:300,300i,400,400i,700,700i%7cRoboto+Mono:400,400i,700,700i%7cRoboto+Slab:400,400i,700,700i" rel="stylesheet"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.5.0/css/all.css" integrity="sha384-B4dIYHKNBt8Bc12p+WXckhzcICo0wtJAoU8YZTY5qE0Id1GSseTk6S+L3BlXeVIU" crossorigin="anonymous"><title>Enable Kerberos authentication in Apache Druid</title><meta name="description" content="As Administrator, you can set up authentication of users who submit queries through Apache Druid (incubating) to the rest of the Hadoop cluster. If Kerberos is enabled on your cluster, to query Druid data sources that are imported from Hive, you must set up LLAP (low-latency, analytical processing)."><link rel="stylesheet" href="/common/css/main.css"><script src="/common/js/main.js"></script></head><body class="hg"><article class="hg-body"><main><div id="content" aria-labelledby="ariaid-title1">
    <h1 class="title topictitle1" id="ariaid-title1">Enable Kerberos authentication in Apache Druid</h1>

    <div class="body taskbody"><p class="shortdesc">As Administrator, you can set up authentication of users who submit queries through
        Apache Druid (incubating) to the rest of the Hadoop cluster. If Kerberos is enabled on your
        cluster, to query Druid data sources that are imported from Hive, you must set up LLAP
        (low-latency, analytical processing).</p>
        <div class="section prereq p">
           <ul class="ul">
               <li class="li">You enabled SPENGO-based Kerberos security on the cluster using the Ambari Server and Services.</li>
               <li class="li">You planned for temporary down-time that is associated with this task. <p class="p">The entire HDP cluster must shut down after you configure the Kerberos settings and initialize the Kerberos wizard.</p></li>
               <li class="li">You set up and enabled LLAP if you want to use Hive and Druid, and Hive Server
                    Interactive is running.</li>
           </ul>

        </div>
        <section class="section context">To enable SPNEGO-based Kerberos authentication between the Druid HTTP endpoints and
            the rest of the Hadoop cluster, you run the Ambari Kerberos Wizard and manually connect
            to Druid HTTP endpoints in a command line. In this wizard, you configure the following
            Advanced Druid Identity Properties.<table class="table frame-all" id="enable_kerberos_authentication__table_a5w_541_j2b"><caption></caption><colgroup><col><col><col></colgroup><thead class="thead">
                        <tr class="row">
                            <th class="entry align-left colsep-1 rowsep-1" id="enable_kerberos_authentication__table_a5w_541_j2b__entry__1">Property</th>
                            <th class="entry align-left colsep-1 rowsep-1" id="enable_kerberos_authentication__table_a5w_541_j2b__entry__2">Default Value Setting</th>
                            <th class="entry align-left colsep-1 rowsep-1" id="enable_kerberos_authentication__table_a5w_541_j2b__entry__3">Description</th>
                        </tr>
                    </thead><tbody class="tbody">
                        <tr class="row">
                            <td class="entry align-left colsep-1 rowsep-1" headers="enable_kerberos_authentication__table_a5w_541_j2b__entry__1 ">
                                <p class="p">druid.hadoop.security.spnego.excludedPaths</p>
                            </td>
                            <td class="entry align-left colsep-1 rowsep-1" headers="enable_kerberos_authentication__table_a5w_541_j2b__entry__2 "> ['status'] <p class="p">To set more than one path, enter values in the
                                    following format:['/status','/condition']</p>
                            </td>
                            <td class="entry align-left colsep-1 rowsep-1" headers="enable_kerberos_authentication__table_a5w_541_j2b__entry__3 ">Specify here HTTP paths that do not need to be secured with
                                authentication. A possible use case for providing paths here are to
                                test scripts outside of a production environment.</td>
                        </tr>
                        <tr class="row">
                            <td class="entry align-left colsep-1 rowsep-1" headers="enable_kerberos_authentication__table_a5w_541_j2b__entry__1 "> druid.hadoop.security.spnego.keytab </td>
                            <td class="entry align-left colsep-1 rowsep-1" headers="enable_kerberos_authentication__table_a5w_541_j2b__entry__2 ">keytab_dir/spnego.service.keytab</td>
                            <td class="entry align-left colsep-1 rowsep-1" headers="enable_kerberos_authentication__table_a5w_541_j2b__entry__3 ">The SPNEGO service keytab that is used for
                                authentication.</td>
                        </tr>
                        <tr class="row">
                            <td class="entry align-left colsep-1 rowsep-1" headers="enable_kerberos_authentication__table_a5w_541_j2b__entry__1 "> druid.hadoop.security.spnego. principal </td>
                            <td class="entry align-left colsep-1 rowsep-1" headers="enable_kerberos_authentication__table_a5w_541_j2b__entry__2 ">HTTP/_HOST@realm</td>
                            <td class="entry align-left colsep-1 rowsep-1" headers="enable_kerberos_authentication__table_a5w_541_j2b__entry__3 ">The SPNEGO service principal that is used for
                                authentication.</td>
                        </tr>
                        <tr class="row">
                            <td class="entry align-left colsep-1 rowsep-1" headers="enable_kerberos_authentication__table_a5w_541_j2b__entry__1 "> druid.security.extensions.loadlist </td>
                            <td class="entry align-left colsep-1 rowsep-1" headers="enable_kerberos_authentication__table_a5w_541_j2b__entry__2 ">[druid-kerberos]</td>
                            <td class="entry align-left colsep-1 rowsep-1" headers="enable_kerberos_authentication__table_a5w_541_j2b__entry__3 ">Indicates the Druid security extension to load for
                                Kerberos.</td>
                        </tr>
                    </tbody></table><p class="p">Initializing the Kerberos Wizard might require a significant amount of time
                to complete, depending on the cluster size. Refer to the GUI messaging on the screen
                for progress status. </p></section>
        <ol class="ol steps"><li class="li step stepexpand">
                <span class="ph cmd">In Ambari, launch the Kerberos wizard automated setup.</span>
            </li><li class="li step stepexpand">
                <span class="ph cmd">In Configure Identities, adjust advanced Druid configuration settings: Review
                    the principal names, particularly the Ambari Principals on the General tab and
                    either leave the default appended names or adjust them by removing the
                    <code class="ph codeph">-cluster-name</code> from the principal name string.</span>
                <div class="itemgroup stepxmp">If your cluster is named druid and your realm is EXAMPLE.COM, the Druid
                    principal that is created is druid@EXAMPLE.COM</div>
                <div class="itemgroup info">These principal names, by default, append the name of the cluster to each of the Ambari principals. </div>
            </li><li class="li step stepexpand">
                <span class="ph cmd">Select the <span class="ph menucascade"><span class="ph uicontrol">Advanced</span><abbr title="and then"> &gt; </abbr><span class="ph uicontrol">Druid drop-down</span></span>.</span>
            </li><li class="li step stepexpand">
                <span class="ph cmd">Determine for which Advanced Druid Identity properties, if any, you need to change the default settings.</span><div class="itemgroup info"> Generally, you do not need to change the default values.</div>
            </li><li class="li step stepexpand">
                <span class="ph cmd">Confirm your configuration, and, ptionally, download a CSV file of the principals and keytabs that Ambari can automatically create.</span>
            </li><li class="li step stepexpand"><span class="ph cmd">Click Next.</span><div class="itemgroup stepresult">Kerberos configuration settings are applied to various components, and keytabs and
                    principals are generated. When the Kerberos process finishes, all Services are
                    restarted and checked. After authenticating successfully to Druid, users can
                    submit queries through the endpoints. </div></li></ol>
    </div>
<nav role="navigation" class="related-links"><div class="linklist relinfo"><strong>Related information</strong><br><div><a class="link" href="/hdp/3.1.0/performance-tuning/content/hive_optimizing_data_warehouse.html" target="_blank">Set up LLAP</a></div></div></nav></div></main><nav class="products"></nav><nav class="topics"></nav><aside class="right-info"></aside></article><header></header><footer></footer><div class="modal fade" id="bModal" tabindex="-1" role="dialog" aria-labelledby="bModalLabel" aria-hidden="true"><div class="modal-dialog" role="document"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="bModalLabel"></h5><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">✖️</span></button></div><div class="modal-body" id="bModalList"></div></div></div></div><script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script><script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script></body></html>
